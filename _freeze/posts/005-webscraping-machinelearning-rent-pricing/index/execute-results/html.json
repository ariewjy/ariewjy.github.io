{
  "hash": "1984859b06872e47531b795c15f5115a",
  "result": {
    "markdown": "---\ntitle: ' Malaysia Property Pricing - Webscraping & Machine Learning Model'\ndescription: |\n  Full details on creating property dataset using webscraping, and building machine learning model to predict the rent price\ntitle-block-banner: true\ndate: '2023-02-10'\ncategories:\n  - project\n  - data-science\n  - python\n  - webscraping\ncode-fold: show\ndraft: false\ncitation-location: document\nbibliography: references.bib\n---\n\n## Machine Learning Project\n\nPacmann Batch 8 Capstone by Aditya Arie Wijaya (aditya-66kK)\n\n### Introduction\n\nThis is a machine learning project to predict unit/property monthly rent price in Kuala Lumpur region, Malaysia. The project uses a dataset from an online ads listing for property [mudah.my](https://www.mudah.my/). This project outlines the process of web-scraping/ data gathering, data cleaning-wrangling, and machine learning modeling.\n\nThis project aims to answers question about how much a unit monthly rent would be if given information such as location, number of bedrooms, parking, furnished, etc? This would help potential tenant and also the owner to get the best price of their rental unit, comparable to the market value.\n\nSome previous work about house pricing was listed below, however most of them are targeting a dataset of house pricing or an Airbnb pricing. There are difference such as in Airbnb, the booking rarely took more than 2 weeks, let alone a year. Therefore the pricing may be different. Additionally, in Airbnb, there is text feature coming from the review given by the tenant and the owner.The better the review, the higher the rent prices -- which was not available in this current project dataset.\n\nPrevious work by [@madhuri2019], [@xu2022], [@zhao2022] highlight the importance feature selection, and the choice of machine learning model. Based on the previous works, the most consistently performed machine learning model are Random Forest and Gradient boosting, and the MAE and R2 score usually used in evaluating the performance of the model. Although the above work are all not about apartment rent pricing, similar method can be applied to this project.\n\n### Data Gathering\n\nThe data will use a scraped data from the website mentioned before, focusing on property-to-rent surrounding Kuala Lumpur, Malaysia. ![Website](mudah_my.png)\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\n#importing libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\npd.set_option('max_colwidth', 200)\nfrom bs4 import BeautifulSoup as bs\nimport requests\nimport re\nimport time\nimport datetime\nimport smtplib\nimport json\nfrom tqdm.notebook import tqdm, trange\nimport time    # to be used in loop iterations\n\n!jupyter nbextension enable --py widgetsnbextension #enabling progress bar\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEnabling notebook extension jupyter-js-widgets/extension...\r\n      - Validating: problems found:\r\n        - require?  X jupyter-js-widgets/extension\r\n```\n:::\n:::\n\n\n#### Web-Scraping Process\n\nThe process started out by gathering data from the website. We are using python library for web-scraping: BeautifulSoup as depicted below. \nThe first process is generating a list of webpage address for a given page number.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\n#generate list address of n_page\ndef page_number(start, end):\n    \"\"\"\n    Description:\n        Function to generate a list of webpage address for a given page number\n\n    Parameters:\n        start (int) : starting page number\n        end (int)   : ending page number\n    Returns:\n        a list of listing web address \n    \n    \"\"\"\n    \n    page_url = 'https://www.mudah.my/kuala-lumpur/apartment-condominium-for-rent?o='\n    list_page = []\n    for i in range(start,end+1):\n        list_page.append(page_url+str(i))\n    return list_page\npage_number(2,4)\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n['https://www.mudah.my/kuala-lumpur/apartment-condominium-for-rent?o=2',\n 'https://www.mudah.my/kuala-lumpur/apartment-condominium-for-rent?o=3',\n 'https://www.mudah.my/kuala-lumpur/apartment-condominium-for-rent?o=4']\n```\n:::\n:::\n\n\nThen generate a list of ads listing on a single page.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n#setting up list of page from \ndef get_list_html(page_url):\n    \"\"\"\n    Description:\n        Function to get every listing ads in a given url (page_url)\n\n    Parameters:\n        page_url (str): website url\n        \n    Returns:\n        a list of listing ads\n    \n    \"\"\"\n    headers = {\"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\"}\n    page = requests.get(url=page_url, headers=headers)\n    soup = bs(page.text, \"html.parser\")\n\n    script_tag = soup.find('script', type='application/ld+json')\n    data = json.loads(script_tag.text)\n    dict_query = data[2]['itemListElement']\n\n    n_query = data[2]['numberOfItems']\n    list_html = []\n\n    for i in range(n_query):\n        link = data[2]['itemListElement'][i]['item']['url']\n        list_html.append(link)\n        \n    return list_html\n\n\n#getting listing property from the 1st-5th in the list\nget_list_html('https://www.mudah.my/neighbouring-kuala-lumpur/apartment-for-rent?o=2')[0:5]\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\n['https://www.mudah.my/Suria+Court+Mahkota+Cheras+-100450215.htm',\n 'https://www.mudah.my/Cemara+Apartment+Bandar+Sri+Permaisuri+Cheras+actual+pic-98750544.htm',\n 'https://www.mudah.my/Seasons+Garden+PV21+850sf+3R2B+Fully+Furnished+Actual+Pics+-100449939.htm',\n 'https://www.mudah.my/Pangsapuri+palma+puteri+with+fully+furnished+seksyen+6-92222541.htm',\n 'https://www.mudah.my/STUDENT+Danau+Perintis+Fully+Furnish+WIFI+PUNCAK+ALAM-100143070.htm']\n```\n:::\n:::\n\n\nCombining the previous two functions, generate a list of url for all pages.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n#generate listing property from each page of n_page\ndef get_list_url(n_page):\n    \"\"\"\n    Description:\n        Function to get every listing ads in every page (n_page)\n\n    Parameters:\n        n_page (int): number of page\n        \n    Returns:\n        a list of listing ads\n    \n    \"\"\"\n    list_html=[]\n    for i in tqdm(range(n_page)):\n        list_html.extend(get_list_html(page_number(1, n_page)[i]))\n    return list_html\n\nget_list_url(2)[:10]\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"87e80f878d734cba96a223c8290fe788\",\"version_major\":2,\"version_minor\":0}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n['https://www.mudah.my/Pertiwi+Indah+1285sf+fully+furnished-98377671.htm',\n 'https://www.mudah.my/PPA1M+Kepong+2+Parking+FULLY+FURNISHED+-95301490.htm',\n 'https://www.mudah.my/PPA1M+Kepong+MARCH+2023+FULLY+FURNISHED+-98845611.htm',\n 'https://www.mudah.my/Ixora+Apartment+Kepong+yang+lengkap+dengan+Time+Internet+Access-100451938.htm',\n 'https://www.mudah.my/Pangsapuri+Permai+Sungai+Besi+3R2B+near+TBS+Bandar+Tasik+Selatan-98987533.htm',\n 'https://www.mudah.my/Inspirasi+Mont+Kiara+BRAND+NEW+RENOVATED+MID+FLOOR+UNIT+NICE+VIEW+-99491862.htm',\n 'https://www.mudah.my/Maxim+Residence+3+Room+3+Aircond+2+Car+Park+Walking+Distance+MRT-100451825.htm',\n 'https://www.mudah.my/Residensi+Harmoni+2+Cheapest+Rental+Near+Mont+Kiara+Sri+Hartamas+KL-100451718.htm',\n 'https://www.mudah.my/Angkasa+Condo+Taman+Connaught+Cheras+Walking+Distance+To+UCSI-100213869.htm',\n 'https://www.mudah.my/Maxim+Residence+Condo+Taman+Len+Cheras-99852286.htm']\n```\n:::\n:::\n\n\nThen extract the attributes inside the listing ads in a form of nested dictionary.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n#extract data from url\ndef get_list_dict(n_page):\n    \"\"\"\n    Description:\n        Function to get dataset (atribut of units) in a form of dictionary. \n\n    Parameters:\n        n_page (int): number of page\n        \n    Returns:\n        a dictionaries of attributes inside a list\n    \n    \"\"\"\n    headers = {\"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\"}\n    list_html = get_list_url(n_page)\n    list_dict = []\n    for url in tqdm(list_html):\n        try:\n            page = requests.get(url=url, headers=headers)\n            soup1 = bs(page.text, \"html.parser\")\n            soup2 = bs(soup1.prettify(), 'html.parser')\n\n            id_html = re.search(r'(\\d+).htm', url).group(1)\n            title = soup2.find(itemprop='name').text.strip()\n\n            script_tag = soup2.find(\"script\", id=\"__NEXT_DATA__\")\n            script_content = script_tag.text\n            data = json.loads(script_content)\n            props = data.get(\"props\", {})\n            id_listing = re.search(r'-(\\d+)\\.htm', url).group(1)\n\n            dict_id = [{'realValue': '', 'id': 'ads_id', 'value': id_listing, 'label': 'id ads'}]\n            dict_building = props[\"initialState\"][\"adDetails\"][\"byID\"][id_listing][\"attributes\"]['propertyParams'][2]['params']\n            dict_prop = props[\"initialState\"][\"adDetails\"][\"byID\"][id_listing][\"attributes\"]['categoryParams']\n            dict_unit = dict_id + dict_building + dict_prop\n        except:\n            None\n        \n        list_dict.append(dict_unit)\n        \n    return list_dict\n\n#sanity check\nget_list_dict(1)[1]\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"cdec6e23b87c4d8db965f85af4bfb506\",\"version_major\":2,\"version_minor\":0}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"e4076aa891e740e38f0f5801e8cb79c6\",\"version_major\":2,\"version_minor\":0}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n[{'realValue': '', 'id': 'ads_id', 'value': '95301490', 'label': 'id ads'},\n {'realValue': 'PPA1M METROPOLITAN KEPONG',\n  'id': 'prop_name',\n  'value': 'PPA1M METROPOLITAN KEPONG',\n  'label': 'Building Name'},\n {'realValue': '', 'id': 'developer_name', 'value': '', 'label': 'Developer'},\n {'realValue': 'BLOK A PPA1M METROPOLITAN KEPONG MRR2, Kuala Lumpur, Kepong',\n  'id': 'full_address',\n  'value': 'BLOK A PPA1M METROPOLITAN KEPONG MRR2, Kuala Lumpur, Kepong',\n  'label': 'Address'},\n {'realValue': '',\n  'id': 'completion_year',\n  'value': '',\n  'label': 'Completion Year'},\n {'realValue': '', 'id': 'num_floors', 'value': '', 'label': '# of Floors'},\n {'realValue': '', 'id': 'num_units', 'value': '', 'label': 'Total Units'},\n {'realValue': 'RM 1 600 per month',\n  'id': 'monthly_rent',\n  'value': 'RM 1 600 per month',\n  'label': 'Monthly Rent'},\n {'realValue': '2020',\n  'id': 'category_id',\n  'value': 'Apartment / Condominium, For rent',\n  'label': 'Category'},\n {'realValue': '9',\n  'id': 'location',\n  'value': 'Kuala Lumpur - Kepong',\n  'label': 'Location'},\n {'realValue': '1',\n  'id': 'property_type',\n  'value': 'Condominium',\n  'label': 'Property Type'},\n {'realValue': '1',\n  'id': 'floor_range',\n  'value': 'High',\n  'label': 'Floor Range'},\n {'realValue': '5', 'id': 'rooms', 'value': '5', 'label': 'Bedrooms'},\n {'realValue': '2', 'id': 'bathroom', 'value': '2', 'label': 'Bathroom'},\n {'realValue': '1500', 'id': 'size', 'value': '1500 sq.ft.', 'label': 'Size'},\n {'realValue': '1',\n  'id': 'furnished',\n  'value': 'Fully Furnished',\n  'label': 'Furnished'},\n {'realValue': '13,9,12,7,5,16',\n  'id': 'facilities',\n  'value': 'Parking, Security, Lift, Playground, Minimart, Multipurpose hall',\n  'label': 'Facilities'},\n {'realValue': '6200',\n  'id': 'rendepo',\n  'value': 'RM 6200',\n  'label': 'Rental Deposit'},\n {'realValue': '1',\n  'id': 'additional_facilities',\n  'value': 'Air-Cond',\n  'label': 'Other Facilities'},\n {'realValue': 'e', 'id': 'firm_type', 'value': 'E', 'label': 'Firm Type'},\n {'realValue': '10091',\n  'id': 'estate_agent',\n  'value': '10091',\n  'label': 'Firm Number'}]\n```\n:::\n:::\n\n\nExtracting the values inside the dictionary for each attributes.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n#getting values out of dictionary\ndef get_values(list_dict):\n    \"\"\"\n    Description:\n        Function to values of the previous dictionary.\n\n    Parameters:\n        list_dict (list): list of dictionary where attributes stored\n        \n    Returns:\n        a list of values (unit/property) attributes\n    \n    \"\"\"\n    keys = [\n        'ads_id',\n        'prop_name',\n        # 'developer_name', \n        # 'address', \n        'completion_year', \n        # 'num_floors', \n        # 'num_units',\n        'monthly_rent', \n        # 'category_id', \n        'location', \n        'property_type', \n        # 'floor_range', \n        'rooms', \n        'parking',\n        'bathroom', \n        'size', \n        'furnished',\n        'facilities', \n        'additional_facilities', \n       ]\n\n    values = {}\n    for key in keys:\n        try:\n            values[key] = next(item['value'] for item in list_dict if item[\"id\"] == key)\n        except StopIteration:\n            values[key] = None\n    return values\n\n#sanity check\nget_values(get_list_dict(1)[1])\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"d18aa32abee74382a92df39a093217a3\",\"version_major\":2,\"version_minor\":0}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"962d189537be469fa1be8c8471915982\",\"version_major\":2,\"version_minor\":0}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\n{'ads_id': '95301490',\n 'prop_name': 'PPA1M METROPOLITAN KEPONG',\n 'completion_year': '',\n 'monthly_rent': 'RM 1 600 per month',\n 'location': 'Kuala Lumpur - Kepong',\n 'property_type': 'Condominium',\n 'rooms': '5',\n 'parking': None,\n 'bathroom': '2',\n 'size': '1500 sq.ft.',\n 'furnished': 'Fully Furnished',\n 'facilities': 'Parking, Security, Lift, Playground, Minimart, Multipurpose hall',\n 'additional_facilities': 'Air-Cond'}\n```\n:::\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n#get df from list\ndef get_df_final(n_page):\n    \"\"\"\n    Description:\n        Function to generate dataframe from the list.\n\n    Parameters:\n        n_page (int): number of page\n        \n    Returns:\n        a dataframe of the list of attributes on each listings.\n    \n    \"\"\"\n    list_data = get_list_dict(n_page)\n    list_new = []\n    for i in range(0,len(list_data)):\n            dic = get_values(list_data[i])\n            list_new.append(dic)\n    \n    df = pd.DataFrame(list_new)\n    return df\n```\n:::\n\n\nOf course we won't scrape 250 pages at first, let's extract 1 page only:\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\n#sanity check\nget_df_final(1).head(2).T\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"29219581cac045eca147a99e3eb27463\",\"version_major\":2,\"version_minor\":0}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<script type=\"application/vnd.jupyter.widget-view+json\">\n{\"model_id\":\"e0a5ae6bf59740d390e7771a434e564a\",\"version_major\":2,\"version_minor\":0}\n</script>\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>ads_id</th>\n      <td>98377671</td>\n      <td>95301490</td>\n    </tr>\n    <tr>\n      <th>prop_name</th>\n      <td></td>\n      <td>PPA1M METROPOLITAN KEPONG</td>\n    </tr>\n    <tr>\n      <th>completion_year</th>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>monthly_rent</th>\n      <td>RM 2 000 per month</td>\n      <td>RM 1 600 per month</td>\n    </tr>\n    <tr>\n      <th>location</th>\n      <td>Kuala Lumpur - Cheras</td>\n      <td>Kuala Lumpur - Kepong</td>\n    </tr>\n    <tr>\n      <th>property_type</th>\n      <td>Condominium</td>\n      <td>Condominium</td>\n    </tr>\n    <tr>\n      <th>rooms</th>\n      <td>3</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>parking</th>\n      <td>1</td>\n      <td>None</td>\n    </tr>\n    <tr>\n      <th>bathroom</th>\n      <td>2</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>size</th>\n      <td>1285 sq.ft.</td>\n      <td>1500 sq.ft.</td>\n    </tr>\n    <tr>\n      <th>furnished</th>\n      <td>Fully Furnished</td>\n      <td>Fully Furnished</td>\n    </tr>\n    <tr>\n      <th>facilities</th>\n      <td>Parking, Security, Playground, Lift, Swimming Pool, Minimart</td>\n      <td>Parking, Security, Lift, Playground, Minimart, Multipurpose hall</td>\n    </tr>\n    <tr>\n      <th>additional_facilities</th>\n      <td>Air-Cond, Cooking Allowed</td>\n      <td>Air-Cond</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nFinally, let's extract dataset from 250 pages. File is then saved into a csv, to be reloaded again.\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\n# df_=get_df_final(250)\n# df_.to_csv('mudah-apartment-raw.csv', index=False)\n## already run, and file is saved\n```\n:::\n\n\n------------------------------------------------------------------------\n\n### Data Understanding\n\nReload the original dataset. \n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n#read it back\ndf = pd.read_csv('./mudah-apartment-raw.csv')\ndf.head(3).T\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>ads_id</th>\n      <td>100323185</td>\n      <td>100203973</td>\n      <td>100323128</td>\n    </tr>\n    <tr>\n      <th>prop_name</th>\n      <td>The Hipster @ Taman Desa</td>\n      <td>Segar Courts</td>\n      <td>Pangsapuri Teratak Muhibbah 2</td>\n    </tr>\n    <tr>\n      <th>completion_year</th>\n      <td>2022.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>monthly_rent</th>\n      <td>RM 4 200 per month</td>\n      <td>RM 2 300 per month</td>\n      <td>RM 1 000 per month</td>\n    </tr>\n    <tr>\n      <th>location</th>\n      <td>Kuala Lumpur - Taman Desa</td>\n      <td>Kuala Lumpur - Cheras</td>\n      <td>Kuala Lumpur - Taman Desa</td>\n    </tr>\n    <tr>\n      <th>property_type</th>\n      <td>Condominium</td>\n      <td>Condominium</td>\n      <td>Apartment</td>\n    </tr>\n    <tr>\n      <th>rooms</th>\n      <td>5</td>\n      <td>3</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>parking</th>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>bathroom</th>\n      <td>6.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>size</th>\n      <td>1842 sq.ft.</td>\n      <td>1170 sq.ft.</td>\n      <td>650 sq.ft.</td>\n    </tr>\n    <tr>\n      <th>furnished</th>\n      <td>Fully Furnished</td>\n      <td>Partially Furnished</td>\n      <td>Fully Furnished</td>\n    </tr>\n    <tr>\n      <th>facilities</th>\n      <td>Minimart, Gymnasium, Security, Playground, Swimming Pool, Parking, Lift, Barbeque area, Multipurpose hall, Jogging Track</td>\n      <td>Playground, Parking, Barbeque area, Security, Jogging Track, Swimming Pool, Gymnasium, Lift, Sauna</td>\n      <td>Minimart, Jogging Track, Lift, Swimming Pool</td>\n    </tr>\n    <tr>\n      <th>additional_facilities</th>\n      <td>Air-Cond, Cooking Allowed, Washing Machine</td>\n      <td>Air-Cond, Cooking Allowed, Near KTM/LRT</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Data Description\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 10000 entries, 0 to 9999\nData columns (total 13 columns):\n #   Column                 Non-Null Count  Dtype  \n---  ------                 --------------  -----  \n 0   ads_id                 10000 non-null  int64  \n 1   prop_name              9492 non-null   object \n 2   completion_year        5623 non-null   float64\n 3   monthly_rent           10000 non-null  object \n 4   location               10000 non-null  object \n 5   property_type          10000 non-null  object \n 6   rooms                  9998 non-null   object \n 7   parking                7368 non-null   float64\n 8   bathroom               9998 non-null   float64\n 9   size                   10000 non-null  object \n 10  furnished              9999 non-null   object \n 11  facilities             9104 non-null   object \n 12  additional_facilities  7167 non-null   object \ndtypes: float64(3), int64(1), object(9)\nmemory usage: 1015.8+ KB\n```\n:::\n:::\n\n\nThe following feature is available in the dataset:\n\n-   `ads_id`: ads listing ID, unique to each ads\n-   `prop_name`: the building name of the property\n-   `completion_year`: year of the building/property completed\n-   `monthly_rent`: monthly rent price in Malaysian Ringgit (RM)\n-   `location`: the location (region) of the property\n-   `property_type`: property type, such as flat, apartment, etc\n-   `rooms`: number of rooms\n-   `parking`: number of parking spot\n-   `bathroom`: number of bathroom\n-   `size`: total area of the unit in sq.ft\n-   `furnished`: furnishin status of the unit, fully-partial-non\n-   `facilities`: main facilities within the unit\n-   `additional_facilities`: additional facilities\n\n#### Drop Duplicate\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\n#cek duplikat\ndf.duplicated().sum()\n\n#drop duplikat\ndf1 = df.drop_duplicates()\n```\n:::\n\n\nSaving the file to csv after remove duplicated values.\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\n# #saving to csv\n# df1.to_csv(\"mudah-apartment-clean.csv\", index=False)\n# #saved already\n```\n:::\n\n\nReload the data after drop duplicates\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\n#reload the data\ndf = pd.read_csv(\"./mudah-apartment-clean.csv\")\n```\n:::\n\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\n#sanity check\ndf.duplicated().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\n0\n```\n:::\n:::\n\n\n#### Extracting Number and Keyword\n\n::: {.cell execution_count=16}\n``` {.python .cell-code}\n#removing RM from monthly rent\ndf['monthly_rent'] = df['monthly_rent'].apply(lambda x: int(re.search(r'RM (.*?) per', x).group(1).replace(' ', '')))\ndf = df.rename(columns={'monthly_rent': 'monthly_rent_rm'})\n\n#dropping sq.ft from size\ndf['size'] = df['size'].apply(lambda x: int(re.search(r'(.*?) sq', x).group(1).replace(' ', '')))\ndf = df.rename(columns={'size': 'size_sqft'})\n\n#dropping kuala lumpur from the location\ndf['location'] = df['location'].apply(lambda x: re.findall(\"\\w+$\", x)[0])\ndf.head(4).T\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>ads_id</th>\n      <td>100323185</td>\n      <td>100203973</td>\n      <td>100323128</td>\n      <td>100191767</td>\n    </tr>\n    <tr>\n      <th>prop_name</th>\n      <td>The Hipster @ Taman Desa</td>\n      <td>Segar Courts</td>\n      <td>Pangsapuri Teratak Muhibbah 2</td>\n      <td>Sentul Point Suite Apartment</td>\n    </tr>\n    <tr>\n      <th>completion_year</th>\n      <td>2022.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2020.0</td>\n    </tr>\n    <tr>\n      <th>monthly_rent_rm</th>\n      <td>4200</td>\n      <td>2300</td>\n      <td>1000</td>\n      <td>1700</td>\n    </tr>\n    <tr>\n      <th>location</th>\n      <td>Desa</td>\n      <td>Cheras</td>\n      <td>Desa</td>\n      <td>Sentul</td>\n    </tr>\n    <tr>\n      <th>property_type</th>\n      <td>Condominium</td>\n      <td>Condominium</td>\n      <td>Apartment</td>\n      <td>Apartment</td>\n    </tr>\n    <tr>\n      <th>rooms</th>\n      <td>5</td>\n      <td>3</td>\n      <td>3</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>parking</th>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>bathroom</th>\n      <td>6.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>size_sqft</th>\n      <td>1842</td>\n      <td>1170</td>\n      <td>650</td>\n      <td>743</td>\n    </tr>\n    <tr>\n      <th>furnished</th>\n      <td>Fully Furnished</td>\n      <td>Partially Furnished</td>\n      <td>Fully Furnished</td>\n      <td>Partially Furnished</td>\n    </tr>\n    <tr>\n      <th>facilities</th>\n      <td>Minimart, Gymnasium, Security, Playground, Swimming Pool, Parking, Lift, Barbeque area, Multipurpose hall, Jogging Track</td>\n      <td>Playground, Parking, Barbeque area, Security, Jogging Track, Swimming Pool, Gymnasium, Lift, Sauna</td>\n      <td>Minimart, Jogging Track, Lift, Swimming Pool</td>\n      <td>Parking, Playground, Swimming Pool, Squash Court, Security, Minimart, Gymnasium, Lift</td>\n    </tr>\n    <tr>\n      <th>additional_facilities</th>\n      <td>Air-Cond, Cooking Allowed, Washing Machine</td>\n      <td>Air-Cond, Cooking Allowed, Near KTM/LRT</td>\n      <td>NaN</td>\n      <td>Cooking Allowed, Near KTM/LRT, Washing Machine</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Extracting Near KTM/LRT\n\nHypotheses: closer access to KTM/LRT = higher monthly rent\n\n::: {.cell execution_count=17}\n``` {.python .cell-code}\n#extracting near KTM/LRT from the additional facilities\ndef extract_near_ktm_lrt(text):\n    pattern = re.compile(r'\\bNear KTM/LRT\\b')\n    try:\n        match = pattern.search(text)\n        if match:\n            return 'yes'\n        return 'no'\n    except TypeError:\n        return text\n```\n:::\n\n\nExtracting \"near KTM/LRT\" into its own column.\n\n::: {.cell execution_count=18}\n``` {.python .cell-code}\ndf['nearby_railways'] = df.additional_facilities.apply(lambda x: extract_near_ktm_lrt(x))\ndf.head(4).T\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>ads_id</th>\n      <td>100323185</td>\n      <td>100203973</td>\n      <td>100323128</td>\n      <td>100191767</td>\n    </tr>\n    <tr>\n      <th>prop_name</th>\n      <td>The Hipster @ Taman Desa</td>\n      <td>Segar Courts</td>\n      <td>Pangsapuri Teratak Muhibbah 2</td>\n      <td>Sentul Point Suite Apartment</td>\n    </tr>\n    <tr>\n      <th>completion_year</th>\n      <td>2022.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>2020.0</td>\n    </tr>\n    <tr>\n      <th>monthly_rent_rm</th>\n      <td>4200</td>\n      <td>2300</td>\n      <td>1000</td>\n      <td>1700</td>\n    </tr>\n    <tr>\n      <th>location</th>\n      <td>Desa</td>\n      <td>Cheras</td>\n      <td>Desa</td>\n      <td>Sentul</td>\n    </tr>\n    <tr>\n      <th>property_type</th>\n      <td>Condominium</td>\n      <td>Condominium</td>\n      <td>Apartment</td>\n      <td>Apartment</td>\n    </tr>\n    <tr>\n      <th>rooms</th>\n      <td>5</td>\n      <td>3</td>\n      <td>3</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>parking</th>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>bathroom</th>\n      <td>6.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n    </tr>\n    <tr>\n      <th>size_sqft</th>\n      <td>1842</td>\n      <td>1170</td>\n      <td>650</td>\n      <td>743</td>\n    </tr>\n    <tr>\n      <th>furnished</th>\n      <td>Fully Furnished</td>\n      <td>Partially Furnished</td>\n      <td>Fully Furnished</td>\n      <td>Partially Furnished</td>\n    </tr>\n    <tr>\n      <th>facilities</th>\n      <td>Minimart, Gymnasium, Security, Playground, Swimming Pool, Parking, Lift, Barbeque area, Multipurpose hall, Jogging Track</td>\n      <td>Playground, Parking, Barbeque area, Security, Jogging Track, Swimming Pool, Gymnasium, Lift, Sauna</td>\n      <td>Minimart, Jogging Track, Lift, Swimming Pool</td>\n      <td>Parking, Playground, Swimming Pool, Squash Court, Security, Minimart, Gymnasium, Lift</td>\n    </tr>\n    <tr>\n      <th>additional_facilities</th>\n      <td>Air-Cond, Cooking Allowed, Washing Machine</td>\n      <td>Air-Cond, Cooking Allowed, Near KTM/LRT</td>\n      <td>NaN</td>\n      <td>Cooking Allowed, Near KTM/LRT, Washing Machine</td>\n    </tr>\n    <tr>\n      <th>nearby_railways</th>\n      <td>no</td>\n      <td>yes</td>\n      <td>NaN</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nPlotting the difference between nearby KTM/LRT or not:\n\n::: {.cell execution_count=19}\n``` {.python .cell-code}\nsns.boxplot(data=df, x='monthly_rent_rm', y='nearby_railways')\nplt.xlim(0,4000);\n\nnear_ktmlrt = df.query(\" nearby_railways == 'yes' \")\nnot_near_ktmlrt = df.query(\" nearby_railways == 'no' \")\n\nprint(f\"\"\" \nMedian:\nNearby KTM/LRT: {near_ktmlrt.monthly_rent_rm.median():.0f}RM\nNot nearby KTM/LRT: {not_near_ktmlrt.monthly_rent_rm.median():.0f}RM\n      \"\"\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n \nMedian:\nNearby KTM/LRT: 1650RM\nNot nearby KTM/LRT: 1600RM\n      \n```\n:::\n\n::: {.cell-output .cell-output-display}\n![Boxplot between Nearby KTM/LRT or Not](index_files/figure-html/fig-nearbyktm-output-2.png){#fig-nearbyktm width=608 height=429}\n:::\n:::\n\n\nSanity check:\n\n::: {.cell execution_count=20}\n``` {.python .cell-code}\ndf[df['prop_name'] == 'Majestic Maxim'][['nearby_railways']].value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\nnearby_railways\nyes                166\nno                  24\ndtype: int64\n```\n:::\n:::\n\n\nAs seen above, @fig-nearbyktm shows that it sligthly increases the median monthly rent by 50RM. However, near KTM/LRT is not appearing in all row even though the property is the same\n\n**Conclusion: Near KTM/LRT may be used, but it can be improved as the listing is inconsistent**\n\n#### Drop Missing Values in Facilities and Additional Facilities\n\n::: {.cell execution_count=21}\n``` {.python .cell-code}\ndf.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```\nads_id                      0\nprop_name                 508\ncompletion_year          4373\nmonthly_rent_rm             0\nlocation                    0\nproperty_type               0\nrooms                       2\nparking                  2630\nbathroom                    2\nsize_sqft                   0\nfurnished                   1\nfacilities                895\nadditional_facilities    2831\nnearby_railways          2831\ndtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=22}\n``` {.python .cell-code}\n#dropping some columns\ndf = df.drop(columns=[\n    'ads_id', \n    'prop_name', \n    'facilities', \n    'additional_facilities',\n    # 'nearby_railways',\n    # 'completion_year'\n])\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>monthly_rent_rm</th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2022.0</td>\n      <td>4200</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>5</td>\n      <td>2.0</td>\n      <td>6.0</td>\n      <td>1842</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NaN</td>\n      <td>2300</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>1170</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>1000</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>650</td>\n      <td>Fully Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2020.0</td>\n      <td>1700</td>\n      <td>Sentul</td>\n      <td>Apartment</td>\n      <td>2</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>743</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NaN</td>\n      <td>1299</td>\n      <td>Kiara</td>\n      <td>Service Residence</td>\n      <td>1</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>494</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>9986</th>\n      <td>2017.0</td>\n      <td>1400</td>\n      <td>Sentul</td>\n      <td>Service Residence</td>\n      <td>3</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>900</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9987</th>\n      <td>1998.0</td>\n      <td>1000</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>657</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9988</th>\n      <td>2021.0</td>\n      <td>1488</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1000</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9989</th>\n      <td>1988.0</td>\n      <td>2000</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>3</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1200</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9990</th>\n      <td>NaN</td>\n      <td>2000</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>1010</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n<p>9991 rows × 10 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=23}\n``` {.python .cell-code}\n#checking dtypes from all columns\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 9991 entries, 0 to 9990\nData columns (total 10 columns):\n #   Column           Non-Null Count  Dtype  \n---  ------           --------------  -----  \n 0   completion_year  5618 non-null   float64\n 1   monthly_rent_rm  9991 non-null   int64  \n 2   location         9991 non-null   object \n 3   property_type    9991 non-null   object \n 4   rooms            9989 non-null   object \n 5   parking          7361 non-null   float64\n 6   bathroom         9989 non-null   float64\n 7   size_sqft        9991 non-null   int64  \n 8   furnished        9990 non-null   object \n 9   nearby_railways  7160 non-null   object \ndtypes: float64(3), int64(2), object(5)\nmemory usage: 780.7+ KB\n```\n:::\n:::\n\n\n::: {.cell execution_count=24}\n``` {.python .cell-code}\n#converting rooms from object to int64\ndf['rooms'] = pd.to_numeric(df['rooms'], downcast='integer', errors='coerce')\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 9991 entries, 0 to 9990\nData columns (total 10 columns):\n #   Column           Non-Null Count  Dtype  \n---  ------           --------------  -----  \n 0   completion_year  5618 non-null   float64\n 1   monthly_rent_rm  9991 non-null   int64  \n 2   location         9991 non-null   object \n 3   property_type    9991 non-null   object \n 4   rooms            9987 non-null   float64\n 5   parking          7361 non-null   float64\n 6   bathroom         9989 non-null   float64\n 7   size_sqft        9991 non-null   int64  \n 8   furnished        9990 non-null   object \n 9   nearby_railways  7160 non-null   object \ndtypes: float64(4), int64(2), object(4)\nmemory usage: 780.7+ KB\n```\n:::\n:::\n\n\n#### Outlier Removal\n\nTo remove some unexplainable data such as 0 monthly rent, 0 size, the rent that is way too old (1970), including the monthly rent that is way too high and/or size too big. \n\n::: {.cell execution_count=25}\n``` {.python .cell-code}\ndf[['size_sqft', 'monthly_rent_rm']].plot(kind='scatter', x='size_sqft', y='monthly_rent_rm');\nplt.ylim(100,5500) #batas harga rent\nplt.xlim(50,3000)  #batas size\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Monthly Rent](index_files/figure-html/fig-size-rent-output-1.png){#fig-size-rent width=619 height=429}\n:::\n:::\n\n\n##### Monthly Rent\n\n::: {.cell execution_count=26}\n``` {.python .cell-code}\nfig, axs = plt.subplots(1,2)\naxs[0].boxplot(data=df, x='monthly_rent_rm')\naxs[0].set_ylim(0,20000)\naxs[0].set_title('all data')\n\naxs[1].boxplot(data=df, x='monthly_rent_rm')\naxs[1].set_ylim(0,5000)\naxs[1].set_title('croped at 5,000 RM')\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Comparison between Different Scale](index_files/figure-html/fig-compare-rent-output-1.png){#fig-compare-rent width=662 height=469}\n:::\n:::\n\n\nBased on EDA on @fig-size-rent and @fig-compare-rent, author decided to filter the data between 100-5500 RM as follows:\n\n::: {.cell execution_count=27}\n``` {.python .cell-code}\n#removing all rows with monthly rent above 5500 RM and below 100RM\ndfx = df.query(\" monthly_rent_rm > 100 & monthly_rent_rm < 5500 \")\ndfx.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>monthly_rent_rm</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>5530.000000</td>\n      <td>9841.000000</td>\n      <td>9838.000000</td>\n      <td>7245.000000</td>\n      <td>9840.000000</td>\n      <td>9.841000e+03</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>2014.863110</td>\n      <td>1786.840260</td>\n      <td>2.742427</td>\n      <td>1.339268</td>\n      <td>1.928760</td>\n      <td>1.111279e+04</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>7.436904</td>\n      <td>768.813626</td>\n      <td>0.763700</td>\n      <td>0.517512</td>\n      <td>0.517118</td>\n      <td>1.008037e+06</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1980.000000</td>\n      <td>110.000000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>1.000000e+00</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>2011.000000</td>\n      <td>1300.000000</td>\n      <td>2.000000</td>\n      <td>1.000000</td>\n      <td>2.000000</td>\n      <td>8.000000e+02</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>2017.000000</td>\n      <td>1600.000000</td>\n      <td>3.000000</td>\n      <td>1.000000</td>\n      <td>2.000000</td>\n      <td>9.080000e+02</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>2020.000000</td>\n      <td>2100.000000</td>\n      <td>3.000000</td>\n      <td>2.000000</td>\n      <td>2.000000</td>\n      <td>1.087000e+03</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>2025.000000</td>\n      <td>5300.000000</td>\n      <td>9.000000</td>\n      <td>10.000000</td>\n      <td>6.000000</td>\n      <td>1.000000e+08</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nSanity check after removal as shown in @fig-rent-final belo:\n\n::: {.cell execution_count=28}\n``` {.python .cell-code}\ndfx.monthly_rent_rm.plot(kind='box', x='monthly_rent_rm');\n```\n\n::: {.cell-output .cell-output-display}\n![Data after Outlier Removal](index_files/figure-html/fig-rent-final-output-1.png){#fig-rent-final width=583 height=411}\n:::\n:::\n\n\n#### Size\n\nChecking the dataset in terms of size.\n\n::: {.cell execution_count=29}\n``` {.python .cell-code}\nfig, axs = plt.subplots(1,2)\naxs[0].boxplot(data=dfx, x='size_sqft')\naxs[0].set_ylim(0,20000)\naxs[0].set_title('all data')\n\naxs[1].boxplot(data=dfx, x='size_sqft')\naxs[1].set_ylim(0,2000)\naxs[1].set_title('croped at 0-2,000 square feet')\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Raw Data Size sq.ft](index_files/figure-html/fig-size-comparison-output-1.png){#fig-size-comparison width=662 height=469}\n:::\n:::\n\n\nStill based on @fig-size-rent, outliers are removed.\n\n::: {.cell execution_count=30}\n``` {.python .cell-code}\n#removing outliers below 500, and higher than 3000 sqft and below 50 sqft\ndfx = \\\n(dfx.query(\" size_sqft > 50 & size_sqft < 3000 \")\n # .size_sqft\n # .plot(kind='box')\n)\ndfx\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>monthly_rent_rm</th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2022.0</td>\n      <td>4200</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>5.0</td>\n      <td>2.0</td>\n      <td>6.0</td>\n      <td>1842</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NaN</td>\n      <td>2300</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>1170</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>1000</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>650</td>\n      <td>Fully Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2020.0</td>\n      <td>1700</td>\n      <td>Sentul</td>\n      <td>Apartment</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>743</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NaN</td>\n      <td>1299</td>\n      <td>Kiara</td>\n      <td>Service Residence</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>494</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>9986</th>\n      <td>2017.0</td>\n      <td>1400</td>\n      <td>Sentul</td>\n      <td>Service Residence</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>900</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9987</th>\n      <td>1998.0</td>\n      <td>1000</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>657</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9988</th>\n      <td>2021.0</td>\n      <td>1488</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1000</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9989</th>\n      <td>1988.0</td>\n      <td>2000</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1200</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9990</th>\n      <td>NaN</td>\n      <td>2000</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>1010</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n<p>9822 rows × 10 columns</p>\n</div>\n```\n:::\n:::\n\n\nSanity check:\n\n::: {.cell execution_count=31}\n``` {.python .cell-code}\ndfx.size_sqft.plot(kind='box');\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-32-output-1.png){width=583 height=413}\n:::\n:::\n\n\n::: {.cell execution_count=32}\n``` {.python .cell-code}\nfig, axs = plt.subplots(1,5, figsize=(12,4))\naxs[0].boxplot(data=dfx.dropna(), x='size_sqft')\naxs[1].boxplot(data=dfx.dropna(), x='rooms')\naxs[2].boxplot(data=dfx.dropna(), x='parking')\naxs[3].boxplot(data=dfx.dropna(), x='bathroom')\n# axs[4].boxplot(data=dfx.dropna(), x='completion_year')\n\naxs[0].set_title('Size')\naxs[1].set_title('Rooms')\naxs[2].set_title('Parking')\naxs[3].set_title('Bathrooms')\n# axs[4].set_title('Completion Year')\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Final Data after Outlier Removal](index_files/figure-html/fig-complete-outliers-output-1.png){#fig-complete-outliers width=1147 height=373}\n:::\n:::\n\n\n### Data Preprocessing\n\n#### Input-Output\n\n::: {.cell execution_count=33}\n``` {.python .cell-code}\ndef extractInputOutput(data,\n                       output_column_name):\n    \"\"\"\n    Fungsi untuk memisahkan data input dan output\n    :param data: <pandas dataframe> data seluruh sample\n    :param output_column_name: <string> nama kolom output\n    :return input_data: <pandas dataframe> data input\n    :return output_data: <pandas series> data output\n    \"\"\"\n    output_data = data[output_column_name]\n    input_data = data.drop(output_column_name,\n                           axis = 1)\n    \n    return input_data, output_data\n```\n:::\n\n\n::: {.cell execution_count=34}\n``` {.python .cell-code}\nX, y = extractInputOutput(data=dfx, output_column_name='monthly_rent_rm')\n```\n:::\n\n\n::: {.cell execution_count=35}\n``` {.python .cell-code}\nX\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2022.0</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>5.0</td>\n      <td>2.0</td>\n      <td>6.0</td>\n      <td>1842</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NaN</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>1170</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>650</td>\n      <td>Fully Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2020.0</td>\n      <td>Sentul</td>\n      <td>Apartment</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>743</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NaN</td>\n      <td>Kiara</td>\n      <td>Service Residence</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>494</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>9986</th>\n      <td>2017.0</td>\n      <td>Sentul</td>\n      <td>Service Residence</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>900</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9987</th>\n      <td>1998.0</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>657</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9988</th>\n      <td>2021.0</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1000</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9989</th>\n      <td>1988.0</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1200</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9990</th>\n      <td>NaN</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>1010</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n<p>9822 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=36}\n``` {.python .cell-code}\ny\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```\n0       4200\n1       2300\n2       1000\n3       1700\n4       1299\n        ... \n9986    1400\n9987    1000\n9988    1488\n9989    2000\n9990    2000\nName: monthly_rent_rm, Length: 9822, dtype: int64\n```\n:::\n:::\n\n\n#### Train-Test Split Data\n\n::: {.cell execution_count=37}\n``` {.python .cell-code}\n#import libraries\nfrom sklearn.model_selection import train_test_split\n```\n:::\n\n\n::: {.cell execution_count=38}\n``` {.python .cell-code}\n# Train test split\nX_train, X_test, y_train, y_test = train_test_split(X, y,\n                                                    test_size = 0.2,\n                                                    random_state = 123)\n```\n:::\n\n\n::: {.cell execution_count=39}\n``` {.python .cell-code}\n#sanity check\nlen(X_test)/len(X)\n```\n\n::: {.cell-output .cell-output-display execution_count=39}\n```\n0.20006108735491754\n```\n:::\n:::\n\n\n::: {.cell execution_count=40}\n``` {.python .cell-code}\n#sanity check\nX_train\n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>5978</th>\n      <td>2020.0</td>\n      <td>Sentul</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>876</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>2151</th>\n      <td>2022.0</td>\n      <td>Setapak</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>850</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9714</th>\n      <td>2002.0</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>1000</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>8556</th>\n      <td>2021.0</td>\n      <td>Cheras</td>\n      <td>Service Residence</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>680</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>2809</th>\n      <td>2005.0</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>920</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>9954</th>\n      <td>2016.0</td>\n      <td>Besi</td>\n      <td>Service Residence</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1121</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>7901</th>\n      <td>NaN</td>\n      <td>Jalil</td>\n      <td>Flat</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>650</td>\n      <td>Not Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>5322</th>\n      <td>2013.0</td>\n      <td>Kepong</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1378</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>1363</th>\n      <td>NaN</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>950</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3648</th>\n      <td>2019.0</td>\n      <td>KLCC</td>\n      <td>Service Residence</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>796</td>\n      <td>Fully Furnished</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>7857 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n**Preprocessing Original Data for Categorical Dtypes**\n\nOne must paying attention to the number of categorical observation in the original data, with respect to the sampling train-test value. If, the test_size = 0.3, that means any categorical observation with a total of 3 and less, would not be distributed evenly among train and test data.\n\n::: {.cell execution_count=41}\n``` {.python .cell-code}\nprint(dfx.location.nunique())\nprint(X_train.location.nunique())\nprint(X_test.location.nunique())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n53\n53\n50\n```\n:::\n:::\n\n\n::: {.cell execution_count=42}\n``` {.python .cell-code}\nprint(dfx.property_type.nunique())\nprint(X_train.property_type.nunique())\nprint(X_test.property_type.nunique())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n9\n9\n8\n```\n:::\n:::\n\n\n::: {.cell execution_count=43}\n``` {.python .cell-code}\nprint(set(X_train.furnished.to_list()) - set(X_test.furnished.to_list()))\nprint(set(X_train.location.to_list()) - set(X_test.location.to_list()))\nprint(set(X_train.property_type.to_list()) - set(X_test.property_type.to_list()))\nprint(set(X_train.nearby_railways.to_list()) - set(X_test.nearby_railways.to_list()))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nset()\n{'Sentral', 'Lin', 'Penchala'}\n{'Condo / Services residence / Penthouse / Townhouse'}\nset()\n```\n:::\n:::\n\n\n> Dropping Data\n\n::: {.cell execution_count=44}\n``` {.python .cell-code}\ndfx\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>monthly_rent_rm</th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2022.0</td>\n      <td>4200</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>5.0</td>\n      <td>2.0</td>\n      <td>6.0</td>\n      <td>1842</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NaN</td>\n      <td>2300</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>1170</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>1000</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>650</td>\n      <td>Fully Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2020.0</td>\n      <td>1700</td>\n      <td>Sentul</td>\n      <td>Apartment</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>743</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NaN</td>\n      <td>1299</td>\n      <td>Kiara</td>\n      <td>Service Residence</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>494</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>9986</th>\n      <td>2017.0</td>\n      <td>1400</td>\n      <td>Sentul</td>\n      <td>Service Residence</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>900</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9987</th>\n      <td>1998.0</td>\n      <td>1000</td>\n      <td>Desa</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>657</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9988</th>\n      <td>2021.0</td>\n      <td>1488</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1000</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9989</th>\n      <td>1988.0</td>\n      <td>2000</td>\n      <td>Desa</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1200</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9990</th>\n      <td>NaN</td>\n      <td>2000</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>1010</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n<p>9822 rows × 10 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=45}\n``` {.python .cell-code}\ndfx.location.value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=45}\n```\nCheras         1614\nSetapak         965\nSentul          776\nKepong          662\nJalil           577\nMaju            456\nAmpang          327\nKeramat         300\nRoad            298\nDesa            295\nCity            268\nKiara           264\nKLCC            239\nIpoh            224\nLama            193\nSegambut        178\nPetaling        174\nPandan          173\nBesi            173\nKuching         168\nSouth           143\nPantai          113\nBintang          99\nMelawati         91\nTitiwangsa       83\nHilir            78\nHartamas         75\nDamansara        73\nOUG              63\nIsmail           59\nDutamas          57\nGombak           56\nPerdana          53\nSetiawangsa      50\nParkCity         50\nBangsar          47\nMenjalara        45\nSeputeh          35\nPuchong          33\nIndah            29\nCentre           25\nJaya             24\nBrickfields      24\nPudu             24\nSelatan          19\nHeights          18\nJinjang           9\nSerdang           9\nSentral           5\nOthers            5\nTunku             2\nPenchala          1\nLin               1\nName: location, dtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=46}\n``` {.python .cell-code}\ndfx.property_type.value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=46}\n```\nCondominium                                           4698\nService Residence                                     2647\nApartment                                             2123\nFlat                                                   265\nStudio                                                  27\nDuplex                                                  27\nOthers                                                  27\nTownhouse Condo                                          7\nCondo / Services residence / Penthouse / Townhouse       1\nName: property_type, dtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=47}\n``` {.python .cell-code}\ndfx_new = dfx[\n    (dfx.location != 'Jinjang') \n    & (dfx.location != 'Serdang') & \n    (dfx.location != 'Sentral') & \n    (dfx.location != 'Others') & \n    (dfx.location != 'Tunku') & \n    (dfx.location != 'Penchala') & \n    (dfx.location != 'Lin') &\n    # (dfx.property_type != 'Others') &\n    (dfx.property_type != 'Condo / Services residence / Penthouse / Townhouse') &\n    (dfx.property_type != 'Townhouse Condo')\n]\n```\n:::\n\n\n::: {.cell execution_count=48}\n``` {.python .cell-code}\ndfx_new.property_type.value_counts()\n```\n\n::: {.cell-output .cell-output-display execution_count=48}\n```\nCondominium          4683\nService Residence    2642\nApartment            2115\nFlat                  263\nDuplex                 27\nStudio                 26\nOthers                 26\nName: property_type, dtype: int64\n```\n:::\n:::\n\n\n> Re-split Training-Test\n\n::: {.cell execution_count=49}\n``` {.python .cell-code}\nX, y = extractInputOutput(data=dfx_new, output_column_name='monthly_rent_rm')\n```\n:::\n\n\n::: {.cell execution_count=50}\n``` {.python .cell-code}\n#import libraries\nfrom sklearn.model_selection import train_test_split\n```\n:::\n\n\n::: {.cell execution_count=51}\n``` {.python .cell-code}\n# Train test split\nX_train, X_test, y_train, y_test = train_test_split(X, y,\n                                                    test_size = 0.2,\n                                                    random_state = 123)\n```\n:::\n\n\n::: {.cell execution_count=52}\n``` {.python .cell-code}\n#sanity check\nlen(X_test)/len(X)\n```\n\n::: {.cell-output .cell-output-display execution_count=52}\n```\n0.2000613371498671\n```\n:::\n:::\n\n\n::: {.cell execution_count=53}\n``` {.python .cell-code}\nX_train\n```\n\n::: {.cell-output .cell-output-display execution_count=53}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>8649</th>\n      <td>NaN</td>\n      <td>Maju</td>\n      <td>Condominium</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>800</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9112</th>\n      <td>1993.0</td>\n      <td>Bangsar</td>\n      <td>Condominium</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>890</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>1472</th>\n      <td>NaN</td>\n      <td>Jalil</td>\n      <td>Condominium</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>1200</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>5536</th>\n      <td>NaN</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>893</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>8152</th>\n      <td>NaN</td>\n      <td>Pudu</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>980</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>7541</th>\n      <td>2001.0</td>\n      <td>Ampang</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>828</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7927</th>\n      <td>NaN</td>\n      <td>South</td>\n      <td>Flat</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>750</td>\n      <td>Not Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5340</th>\n      <td>2023.0</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1000</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>1369</th>\n      <td>NaN</td>\n      <td>KLCC</td>\n      <td>Condominium</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>473</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>3659</th>\n      <td>2017.0</td>\n      <td>Road</td>\n      <td>Service Residence</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>953</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>7825 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=54}\n``` {.python .cell-code}\nprint(set(X_train.furnished.to_list()) - set(X_test.furnished.to_list()))\nprint(set(X_train.location.to_list()) - set(X_test.location.to_list()))\nprint(set(X_train.property_type.to_list()) - set(X_test.property_type.to_list()))\n# print(set(X_train.nearby_railways.to_list()) - set(X_test.nearby_railways.to_list()))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nset()\nset()\nset()\n```\n:::\n:::\n\n\n::: {.cell execution_count=55}\n``` {.python .cell-code}\nprint(dfx_new.location.nunique())\nprint(X_train.location.nunique())\nprint(X_test.location.nunique())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n46\n46\n46\n```\n:::\n:::\n\n\n::: {.cell execution_count=56}\n``` {.python .cell-code}\n#sanity check\nX_train\n```\n\n::: {.cell-output .cell-output-display execution_count=56}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>8649</th>\n      <td>NaN</td>\n      <td>Maju</td>\n      <td>Condominium</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>800</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9112</th>\n      <td>1993.0</td>\n      <td>Bangsar</td>\n      <td>Condominium</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>890</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>1472</th>\n      <td>NaN</td>\n      <td>Jalil</td>\n      <td>Condominium</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>1200</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>5536</th>\n      <td>NaN</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>893</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>8152</th>\n      <td>NaN</td>\n      <td>Pudu</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>980</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>7541</th>\n      <td>2001.0</td>\n      <td>Ampang</td>\n      <td>Apartment</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>828</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7927</th>\n      <td>NaN</td>\n      <td>South</td>\n      <td>Flat</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>750</td>\n      <td>Not Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5340</th>\n      <td>2023.0</td>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1000</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>1369</th>\n      <td>NaN</td>\n      <td>KLCC</td>\n      <td>Condominium</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>473</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>3659</th>\n      <td>2017.0</td>\n      <td>Road</td>\n      <td>Service Residence</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>953</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>7825 rows × 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=57}\n``` {.python .cell-code}\n#export data training\nX_train.to_csv('X_train.csv', index=False)\ny_train.to_csv('y_train.csv', index=False)\n```\n:::\n\n\n::: {.cell execution_count=58}\n``` {.python .cell-code}\n#export data testing\nX_test.to_csv('X_test.csv', index=False)\ny_test.to_csv('y_test.csv', index=False)\n```\n:::\n\n\n### Training Data Imputation\n\n::: {.cell execution_count=59}\n``` {.python .cell-code}\n#checking null data\nX_train.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=59}\n```\ncompletion_year    3438\nlocation              0\nproperty_type         0\nrooms                 2\nparking            2074\nbathroom              0\nsize_sqft             0\nfurnished             0\nnearby_railways    2206\ndtype: int64\n```\n:::\n:::\n\n\n#### Numerical Data\n\n::: {.cell execution_count=60}\n``` {.python .cell-code}\nX_train_num =  X_train.select_dtypes(exclude='object')\nX_train_num\n```\n\n::: {.cell-output .cell-output-display execution_count=60}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>8649</th>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>800</td>\n    </tr>\n    <tr>\n      <th>9112</th>\n      <td>1993.0</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>890</td>\n    </tr>\n    <tr>\n      <th>1472</th>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>1200</td>\n    </tr>\n    <tr>\n      <th>5536</th>\n      <td>NaN</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>893</td>\n    </tr>\n    <tr>\n      <th>8152</th>\n      <td>NaN</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>980</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>7541</th>\n      <td>2001.0</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>828</td>\n    </tr>\n    <tr>\n      <th>7927</th>\n      <td>NaN</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>750</td>\n    </tr>\n    <tr>\n      <th>5340</th>\n      <td>2023.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1000</td>\n    </tr>\n    <tr>\n      <th>1369</th>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>473</td>\n    </tr>\n    <tr>\n      <th>3659</th>\n      <td>2017.0</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>953</td>\n    </tr>\n  </tbody>\n</table>\n<p>7825 rows × 5 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=61}\n``` {.python .cell-code}\nX_train_num.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=61}\n```\ncompletion_year    3438\nrooms                 2\nparking            2074\nbathroom              0\nsize_sqft             0\ndtype: int64\n```\n:::\n:::\n\n\n-   We can fill completion year, rooms, parking and bathroom with mode\n\n::: {.cell execution_count=62}\n``` {.python .cell-code}\nfrom sklearn.impute import SimpleImputer\n\ndef numericalImputation(X_train_num, strategy = 'most_frequent'):\n    \"\"\"\n    Fungsi untuk melakukan imputasi data numerik NaN\n    :param data: <pandas dataframe> sample data input\n\n    :return X_train_numerical: <pandas dataframe> data numerik\n    :return imputer_numerical: numerical imputer method\n    \"\"\"\n    #buat imputer\n    imputer_num = SimpleImputer(missing_values = np.nan, strategy = strategy)\n    \n    #fitting\n    imputer_num.fit(X_train_num)\n\n    # transform\n    imputed_data = imputer_num.transform(X_train_num)\n    X_train_num_imputed = pd.DataFrame(imputed_data)\n\n    #pastikan index dan nama kolom antara imputed dan non-imputed SAMA\n    X_train_num_imputed.columns = X_train_num.columns\n    X_train_num_imputed.index = X_train_num.index\n\n    return X_train_num_imputed, imputer_num\n```\n:::\n\n\n::: {.cell execution_count=63}\n``` {.python .cell-code}\nX_train_num, imputer_num = numericalImputation(X_train_num, strategy='most_frequent')\nX_train_num.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=63}\n```\ncompletion_year    0\nrooms              0\nparking            0\nbathroom           0\nsize_sqft          0\ndtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=64}\n``` {.python .cell-code}\nimputer_num\n```\n\n::: {.cell-output .cell-output-display execution_count=64}\n```{=html}\n<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SimpleImputer</label><div class=\"sk-toggleable__content\"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div></div></div>\n```\n:::\n:::\n\n\n#### Categorical Data\n\n::: {.cell execution_count=65}\n``` {.python .cell-code}\nX_train_cat = X_train.select_dtypes(include='object')\nX_train_cat\n```\n\n::: {.cell-output .cell-output-display execution_count=65}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>8649</th>\n      <td>Maju</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9112</th>\n      <td>Bangsar</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>1472</th>\n      <td>Jalil</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>5536</th>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>8152</th>\n      <td>Pudu</td>\n      <td>Apartment</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>7541</th>\n      <td>Ampang</td>\n      <td>Apartment</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>7927</th>\n      <td>South</td>\n      <td>Flat</td>\n      <td>Not Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>5340</th>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>1369</th>\n      <td>KLCC</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>3659</th>\n      <td>Road</td>\n      <td>Service Residence</td>\n      <td>Partially Furnished</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>7825 rows × 4 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=66}\n``` {.python .cell-code}\nX_train_cat.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=66}\n```\nlocation              0\nproperty_type         0\nfurnished             0\nnearby_railways    2206\ndtype: int64\n```\n:::\n:::\n\n\n-   Impute with mode\n\n::: {.cell execution_count=67}\n``` {.python .cell-code}\nX_train_cat, imputer_num = numericalImputation(X_train_cat, strategy='most_frequent')\nX_train_cat.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=67}\n```\nlocation           0\nproperty_type      0\nfurnished          0\nnearby_railways    0\ndtype: int64\n```\n:::\n:::\n\n\n#### Preprocessing Categorical Variable\n\n::: {.cell execution_count=68}\n``` {.python .cell-code}\nX_train_cat_ohe =  pd.get_dummies(X_train_cat)\nX_train_cat_ohe.head(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=68}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>location_Ampang</th>\n      <th>location_Bangsar</th>\n      <th>location_Besi</th>\n      <th>location_Bintang</th>\n      <th>location_Brickfields</th>\n      <th>location_Centre</th>\n      <th>location_Cheras</th>\n      <th>location_City</th>\n      <th>location_Damansara</th>\n      <th>location_Desa</th>\n      <th>...</th>\n      <th>property_type_Duplex</th>\n      <th>property_type_Flat</th>\n      <th>property_type_Others</th>\n      <th>property_type_Service Residence</th>\n      <th>property_type_Studio</th>\n      <th>furnished_Fully Furnished</th>\n      <th>furnished_Not Furnished</th>\n      <th>furnished_Partially Furnished</th>\n      <th>nearby_railways_no</th>\n      <th>nearby_railways_yes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>8649</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>9112</th>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 58 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=69}\n``` {.python .cell-code}\nohe_columns = X_train_cat_ohe.columns\nohe_columns\n```\n\n::: {.cell-output .cell-output-display execution_count=69}\n```\nIndex(['location_Ampang', 'location_Bangsar', 'location_Besi',\n       'location_Bintang', 'location_Brickfields', 'location_Centre',\n       'location_Cheras', 'location_City', 'location_Damansara',\n       'location_Desa', 'location_Dutamas', 'location_Gombak',\n       'location_Hartamas', 'location_Heights', 'location_Hilir',\n       'location_Indah', 'location_Ipoh', 'location_Ismail', 'location_Jalil',\n       'location_Jaya', 'location_KLCC', 'location_Kepong', 'location_Keramat',\n       'location_Kiara', 'location_Kuching', 'location_Lama', 'location_Maju',\n       'location_Melawati', 'location_Menjalara', 'location_OUG',\n       'location_Pandan', 'location_Pantai', 'location_ParkCity',\n       'location_Perdana', 'location_Petaling', 'location_Puchong',\n       'location_Pudu', 'location_Road', 'location_Segambut',\n       'location_Selatan', 'location_Sentul', 'location_Seputeh',\n       'location_Setapak', 'location_Setiawangsa', 'location_South',\n       'location_Titiwangsa', 'property_type_Apartment',\n       'property_type_Condominium', 'property_type_Duplex',\n       'property_type_Flat', 'property_type_Others',\n       'property_type_Service Residence', 'property_type_Studio',\n       'furnished_Fully Furnished', 'furnished_Not Furnished',\n       'furnished_Partially Furnished', 'nearby_railways_no',\n       'nearby_railways_yes'],\n      dtype='object')\n```\n:::\n:::\n\n\n::: {.cell execution_count=70}\n``` {.python .cell-code}\nX_train_cat_ohe.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=70}\n```\nlocation_Ampang                    0\nlocation_Bangsar                   0\nlocation_Besi                      0\nlocation_Bintang                   0\nlocation_Brickfields               0\nlocation_Centre                    0\nlocation_Cheras                    0\nlocation_City                      0\nlocation_Damansara                 0\nlocation_Desa                      0\nlocation_Dutamas                   0\nlocation_Gombak                    0\nlocation_Hartamas                  0\nlocation_Heights                   0\nlocation_Hilir                     0\nlocation_Indah                     0\nlocation_Ipoh                      0\nlocation_Ismail                    0\nlocation_Jalil                     0\nlocation_Jaya                      0\nlocation_KLCC                      0\nlocation_Kepong                    0\nlocation_Keramat                   0\nlocation_Kiara                     0\nlocation_Kuching                   0\nlocation_Lama                      0\nlocation_Maju                      0\nlocation_Melawati                  0\nlocation_Menjalara                 0\nlocation_OUG                       0\nlocation_Pandan                    0\nlocation_Pantai                    0\nlocation_ParkCity                  0\nlocation_Perdana                   0\nlocation_Petaling                  0\nlocation_Puchong                   0\nlocation_Pudu                      0\nlocation_Road                      0\nlocation_Segambut                  0\nlocation_Selatan                   0\nlocation_Sentul                    0\nlocation_Seputeh                   0\nlocation_Setapak                   0\nlocation_Setiawangsa               0\nlocation_South                     0\nlocation_Titiwangsa                0\nproperty_type_Apartment            0\nproperty_type_Condominium          0\nproperty_type_Duplex               0\nproperty_type_Flat                 0\nproperty_type_Others               0\nproperty_type_Service Residence    0\nproperty_type_Studio               0\nfurnished_Fully Furnished          0\nfurnished_Not Furnished            0\nfurnished_Partially Furnished      0\nnearby_railways_no                 0\nnearby_railways_yes                0\ndtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=71}\n``` {.python .cell-code}\nX_train_num.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=71}\n```\ncompletion_year    0\nrooms              0\nparking            0\nbathroom           0\nsize_sqft          0\ndtype: int64\n```\n:::\n:::\n\n\n#### Penggabungan Numerical dan Categorical data\n\n::: {.cell execution_count=72}\n``` {.python .cell-code}\nX_train_concat = pd.concat([X_train_num,\n                            X_train_cat_ohe],\n                           axis = 1)\n```\n:::\n\n\n::: {.cell execution_count=73}\n``` {.python .cell-code}\nX_train_concat.head(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=73}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>location_Ampang</th>\n      <th>location_Bangsar</th>\n      <th>location_Besi</th>\n      <th>location_Bintang</th>\n      <th>location_Brickfields</th>\n      <th>...</th>\n      <th>property_type_Duplex</th>\n      <th>property_type_Flat</th>\n      <th>property_type_Others</th>\n      <th>property_type_Service Residence</th>\n      <th>property_type_Studio</th>\n      <th>furnished_Fully Furnished</th>\n      <th>furnished_Not Furnished</th>\n      <th>furnished_Partially Furnished</th>\n      <th>nearby_railways_no</th>\n      <th>nearby_railways_yes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>8649</th>\n      <td>2021.0</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>800.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>9112</th>\n      <td>1993.0</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>890.0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 63 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=74}\n``` {.python .cell-code}\n#sanity check\nX_train_concat.isnull().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=74}\n```\ncompletion_year                  0\nrooms                            0\nparking                          0\nbathroom                         0\nsize_sqft                        0\n                                ..\nfurnished_Fully Furnished        0\nfurnished_Not Furnished          0\nfurnished_Partially Furnished    0\nnearby_railways_no               0\nnearby_railways_yes              0\nLength: 63, dtype: int64\n```\n:::\n:::\n\n\n#### Standarisasi\n\n::: {.cell execution_count=75}\n``` {.python .cell-code}\nfrom sklearn.preprocessing import StandardScaler\n\n# Buat fungsi\ndef standardizerData(data):\n    \"\"\"\n    Fungsi untuk melakukan standarisasi data\n    :param data: <pandas dataframe> sampel data\n    :return standardized_data: <pandas dataframe> sampel data standard\n    :return standardizer: method untuk standardisasi data\n    \"\"\"\n    data_columns = data.columns  # agar nama kolom tidak hilang\n    data_index = data.index  # agar index tidak hilang\n\n    # buat (fit) standardizer\n    standardizer = StandardScaler()\n    standardizer.fit(data)\n\n    # transform data\n    standardized_data_raw = standardizer.transform(data)\n    standardized_data = pd.DataFrame(standardized_data_raw)\n    standardized_data.columns = data_columns\n    standardized_data.index = data_index\n\n    return standardized_data, standardizer\n```\n:::\n\n\n::: {.cell execution_count=76}\n``` {.python .cell-code}\nX_train_clean, standardizer = standardizerData(data = X_train_concat)\n```\n:::\n\n\n::: {.cell execution_count=77}\n``` {.python .cell-code}\nX_train_clean.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=77}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>location_Ampang</th>\n      <th>location_Bangsar</th>\n      <th>location_Besi</th>\n      <th>location_Bintang</th>\n      <th>location_Brickfields</th>\n      <th>...</th>\n      <th>property_type_Duplex</th>\n      <th>property_type_Flat</th>\n      <th>property_type_Others</th>\n      <th>property_type_Service Residence</th>\n      <th>property_type_Studio</th>\n      <th>furnished_Fully Furnished</th>\n      <th>furnished_Not Furnished</th>\n      <th>furnished_Partially Furnished</th>\n      <th>nearby_railways_no</th>\n      <th>nearby_railways_yes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>8649</th>\n      <td>0.541336</td>\n      <td>-0.971807</td>\n      <td>-0.542258</td>\n      <td>-1.813058</td>\n      <td>-0.530030</td>\n      <td>-0.189407</td>\n      <td>-0.068927</td>\n      <td>-0.137405</td>\n      <td>-0.102909</td>\n      <td>-0.048017</td>\n      <td>...</td>\n      <td>-0.050621</td>\n      <td>-0.167279</td>\n      <td>-0.049336</td>\n      <td>-0.60979</td>\n      <td>-0.053098</td>\n      <td>1.072803</td>\n      <td>-0.406146</td>\n      <td>-0.805454</td>\n      <td>-0.619460</td>\n      <td>0.619460</td>\n    </tr>\n    <tr>\n      <th>9112</th>\n      <td>-3.913712</td>\n      <td>-0.971807</td>\n      <td>-0.542258</td>\n      <td>-1.813058</td>\n      <td>-0.190258</td>\n      <td>-0.189407</td>\n      <td>14.508152</td>\n      <td>-0.137405</td>\n      <td>-0.102909</td>\n      <td>-0.048017</td>\n      <td>...</td>\n      <td>-0.050621</td>\n      <td>-0.167279</td>\n      <td>-0.049336</td>\n      <td>-0.60979</td>\n      <td>-0.053098</td>\n      <td>1.072803</td>\n      <td>-0.406146</td>\n      <td>-0.805454</td>\n      <td>-0.619460</td>\n      <td>0.619460</td>\n    </tr>\n    <tr>\n      <th>1472</th>\n      <td>0.541336</td>\n      <td>-2.288585</td>\n      <td>-0.542258</td>\n      <td>-1.813058</td>\n      <td>0.980069</td>\n      <td>-0.189407</td>\n      <td>-0.068927</td>\n      <td>-0.137405</td>\n      <td>-0.102909</td>\n      <td>-0.048017</td>\n      <td>...</td>\n      <td>-0.050621</td>\n      <td>-0.167279</td>\n      <td>-0.049336</td>\n      <td>-0.60979</td>\n      <td>-0.053098</td>\n      <td>1.072803</td>\n      <td>-0.406146</td>\n      <td>-0.805454</td>\n      <td>-0.619460</td>\n      <td>0.619460</td>\n    </tr>\n    <tr>\n      <th>5536</th>\n      <td>0.541336</td>\n      <td>0.344970</td>\n      <td>1.685126</td>\n      <td>0.150837</td>\n      <td>-0.178932</td>\n      <td>-0.189407</td>\n      <td>-0.068927</td>\n      <td>-0.137405</td>\n      <td>-0.102909</td>\n      <td>-0.048017</td>\n      <td>...</td>\n      <td>-0.050621</td>\n      <td>-0.167279</td>\n      <td>-0.049336</td>\n      <td>-0.60979</td>\n      <td>-0.053098</td>\n      <td>1.072803</td>\n      <td>-0.406146</td>\n      <td>-0.805454</td>\n      <td>1.614308</td>\n      <td>-1.614308</td>\n    </tr>\n    <tr>\n      <th>8152</th>\n      <td>0.541336</td>\n      <td>0.344970</td>\n      <td>-0.542258</td>\n      <td>0.150837</td>\n      <td>0.149515</td>\n      <td>-0.189407</td>\n      <td>-0.068927</td>\n      <td>-0.137405</td>\n      <td>-0.102909</td>\n      <td>-0.048017</td>\n      <td>...</td>\n      <td>-0.050621</td>\n      <td>-0.167279</td>\n      <td>-0.049336</td>\n      <td>-0.60979</td>\n      <td>-0.053098</td>\n      <td>-0.932137</td>\n      <td>-0.406146</td>\n      <td>1.241535</td>\n      <td>-0.619460</td>\n      <td>0.619460</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 63 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Training Machine Learning\n\nSince this is a regression model, R2 score and mean absolute error (MAE) will be used as a performance metrics.\n\nThe machine learning model will use baseline from average value of the target columns (monthly rent) and also result from linear regression model. After that, author used some of the recommended model based on previous works, which are random forest and gradient boosting to better improve the performance of the model.\n\n#### Baseline-Average Value\n\nThe concept here is to use average value of the target as the easiest way to predict the monhtly rent of a unit.\n\n::: {.cell execution_count=78}\n``` {.python .cell-code}\ny_baseline = np.ones(len(y_train)) * y_train.mean()\ny_baseline\n```\n\n::: {.cell-output .cell-output-display execution_count=78}\n```\narray([1780.0086901, 1780.0086901, 1780.0086901, ..., 1780.0086901,\n       1780.0086901, 1780.0086901])\n```\n:::\n:::\n\n\n::: {.cell execution_count=79}\n``` {.python .cell-code}\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\n\n# Train the linear regression model\nlin_reg = LinearRegression().fit(X_train_clean, y_train)\n\n# Predict using the train data\ny_pred_train = y_baseline\n\n# Calculate R-squared\nr2_baseline = r2_score(y_train, y_pred_train)\n\n#calculate MAE\nmae_baseline = mean_absolute_error(y_train, y_pred_train)\n\nprint(f\"R2-score: {r2_baseline:.4f} and MAE score: {mae_baseline:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.0000 and MAE score: 562.3710\n```\n:::\n:::\n\n\n::: {.cell execution_count=80}\n``` {.python .cell-code}\nplt.scatter(x=y_train, y=y_pred_train);\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-81-output-1.png){width=583 height=411}\n:::\n:::\n\n\n#### Baseline-Linear Regression\n\nThe second method is using linear regression, which simply put is finding the minum total error (distance) between predicted value and the target value, using linear equation. \n\n::: {.cell execution_count=81}\n``` {.python .cell-code}\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error, r2_score\n\n# Train the linear regression model\nlin_reg = LinearRegression().fit(X_train_clean, y_train)\n\n# Predict using the train data\n# y_pred = y_baseline\ny_pred_train = lin_reg.predict(X_train_clean)\n\n# Calculate mean absolute error\nmae_linreg = mean_absolute_error(y_train, y_pred_train)\n\n# Calculate R-squared\nr2_linreg = r2_score(y_train, y_pred_train)\n\nprint(f\"R2-score: {r2_linreg:.4f} and MAE score: {mae_linreg:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.6468 and MAE score: 319.2229\n```\n:::\n:::\n\n\n::: {.cell execution_count=82}\n``` {.python .cell-code}\nsns.jointplot(x=y_train, y=y_pred_train);\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-83-output-1.png){width=579 height=564}\n:::\n:::\n\n\n#### GradientBoosting\n\nThe gradient boosting, is one of the recommendation from previous works, is a model where each sample would be given a different weights (boosts) depending on its performance in predicting the value/ target. \n\n::: {.cell execution_count=83}\n``` {.python .cell-code}\nfrom sklearn.ensemble import GradientBoostingRegressor\n# Build random forest\ngrad_tree = GradientBoostingRegressor(random_state = 123)\n```\n:::\n\n\n::: {.cell execution_count=84}\n``` {.python .cell-code}\n# Fit random forest\ngrad_tree.fit(X_train_clean, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=84}\n```{=html}\n<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-2\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GradientBoostingRegressor(random_state=123)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" checked><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GradientBoostingRegressor</label><div class=\"sk-toggleable__content\"><pre>GradientBoostingRegressor(random_state=123)</pre></div></div></div></div></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=85}\n``` {.python .cell-code}\n# Predict\ny_pred_train = grad_tree.predict(X_train_clean)\n# y_pred_test = grad_tree.predict(X_test_clean)\n\n# Calculate mean absolute error\nmae_gb = mean_absolute_error(y_train, y_pred_train)\n\n# Calculate R-squared\nr2_gb = r2_score(y_train, y_pred_train)\n\nprint(f\"R2-score: {r2_gb:.4f} and MAE score: {mae_gb:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.7246 and MAE score: 281.6835\n```\n:::\n:::\n\n\n::: {.cell execution_count=86}\n``` {.python .cell-code}\nsns.jointplot(x=y_train, y=y_pred_train);\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-87-output-1.png){width=579 height=564}\n:::\n:::\n\n\n::: {.cell execution_count=87}\n``` {.python .cell-code}\n#gridsearch\n\nfrom sklearn.model_selection import GridSearchCV \n\n\nparams = {'n_estimators': [100, 200, 300, 400, 500],\n              'learning_rate': [0.1, 0.05, 0.01]}\n\n# Buat gridsearch\ngrad_tree = GradientBoostingRegressor(random_state = 123)\n\ngrad_tree_cv = GridSearchCV(estimator = grad_tree,\n                           param_grid = params,\n                           cv = 5,\n                           scoring = \"neg_mean_absolute_error\")\n```\n:::\n\n\n::: {.cell execution_count=88}\n``` {.python .cell-code}\n# Fit grid search cv\ngrad_tree_cv.fit(X_train_clean, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=88}\n```{=html}\n<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-3\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(cv=5, estimator=GradientBoostingRegressor(random_state=123),\n             param_grid={&#x27;learning_rate&#x27;: [0.1, 0.05, 0.01],\n                         &#x27;n_estimators&#x27;: [100, 200, 300, 400, 500]},\n             scoring=&#x27;neg_mean_absolute_error&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(cv=5, estimator=GradientBoostingRegressor(random_state=123),\n             param_grid={&#x27;learning_rate&#x27;: [0.1, 0.05, 0.01],\n                         &#x27;n_estimators&#x27;: [100, 200, 300, 400, 500]},\n             scoring=&#x27;neg_mean_absolute_error&#x27;)</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: GradientBoostingRegressor</label><div class=\"sk-toggleable__content\"><pre>GradientBoostingRegressor(random_state=123)</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GradientBoostingRegressor</label><div class=\"sk-toggleable__content\"><pre>GradientBoostingRegressor(random_state=123)</pre></div></div></div></div></div></div></div></div></div></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=89}\n``` {.python .cell-code}\n# Best params\ngrad_tree_cv.best_params_\n```\n\n::: {.cell-output .cell-output-display execution_count=89}\n```\n{'learning_rate': 0.1, 'n_estimators': 500}\n```\n:::\n:::\n\n\n::: {.cell execution_count=90}\n``` {.python .cell-code}\n# Refit the Adaboost\ngrad_tree = GradientBoostingRegressor(n_estimators = grad_tree_cv.best_params_[\"n_estimators\"],\n                                      random_state = 123)\n\ngrad_tree.fit(X_train_clean, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=90}\n```{=html}\n<style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-4\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GradientBoostingRegressor(n_estimators=500, random_state=123)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-6\" type=\"checkbox\" checked><label for=\"sk-estimator-id-6\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GradientBoostingRegressor</label><div class=\"sk-toggleable__content\"><pre>GradientBoostingRegressor(n_estimators=500, random_state=123)</pre></div></div></div></div></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=91}\n``` {.python .cell-code}\n# Predict\ny_pred_train = grad_tree.predict(X_train_clean)\n\n# Calculate mean absolute error\nmae_gb_cv = mean_absolute_error(y_train, y_pred_train)\n\n# Calculate R-squared\nr2_gb_cv = r2_score(y_train, y_pred_train)\n\nprint(f\"R2-score: {r2_gb_cv:.4f} and MAE score: {mae_gb_cv:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.8194 and MAE score: 228.0225\n```\n:::\n:::\n\n\n::: {.cell execution_count=92}\n``` {.python .cell-code}\nsns.jointplot(x=y_train, y=y_pred_train);\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-93-output-1.png){width=579 height=564}\n:::\n:::\n\n\n#### Random Forest\n\nThe last model, which was also recommended by previous works, is a model where not only it has weights based on its performance, but the feature selection in which the sample is measured was done at **random**. Therefore, reduces not only the variance, but also the bias. \n\n::: {.cell execution_count=93}\n``` {.python .cell-code}\nfrom sklearn.ensemble import RandomForestRegressor\n```\n:::\n\n\n::: {.cell execution_count=94}\n``` {.python .cell-code}\n# Build random forest\nrf_tree = RandomForestRegressor(n_estimators = 100,\n                                criterion = \"squared_error\",\n                                max_features = \"sqrt\",\n                                random_state = 123)\n```\n:::\n\n\n::: {.cell execution_count=95}\n``` {.python .cell-code}\n# Fit random forest\nrf_tree.fit(X_train_clean, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=95}\n```{=html}\n<style>#sk-container-id-5 {color: black;background-color: white;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-5\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestRegressor(max_features=&#x27;sqrt&#x27;, random_state=123)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-7\" type=\"checkbox\" checked><label for=\"sk-estimator-id-7\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestRegressor</label><div class=\"sk-toggleable__content\"><pre>RandomForestRegressor(max_features=&#x27;sqrt&#x27;, random_state=123)</pre></div></div></div></div></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=96}\n``` {.python .cell-code}\n# Predict\ny_pred_train = rf_tree.predict(X_train_clean)\n\n# Calculate mean absolute error\nmae_rf = mean_absolute_error(y_train, y_pred_train)\n\n# Calculate R-squared\nr2_rf = r2_score(y_train, y_pred_train)\n\nprint(f\"R2-score: {r2_rf:.4f} and MAE score: {mae_rf:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.9577 and MAE score: 100.8408\n```\n:::\n:::\n\n\n::: {.cell execution_count=97}\n``` {.python .cell-code}\nsns.jointplot(x=y_train, y=y_pred_train);\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-98-output-1.png){width=579 height=564}\n:::\n:::\n\n\n::: {.cell execution_count=98}\n``` {.python .cell-code}\nparams = {\"n_estimators\": [100, 200, 300, 500 ],\n          \"max_features\": [\"sqrt\", \"log2\"]}\n\n# Buat gridsearch\nrf_tree = RandomForestRegressor(criterion = \"squared_error\",\n                                random_state = 123)\n\nrf_tree_cv = GridSearchCV(estimator = rf_tree,\n                          param_grid = params,\n                          cv = 5,\n                          scoring = \"neg_mean_absolute_error\")\n```\n:::\n\n\n::: {.cell execution_count=99}\n``` {.python .cell-code}\n# Fit grid search cv\nrf_tree_cv.fit(X_train_clean, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=99}\n```{=html}\n<style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-6\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(cv=5, estimator=RandomForestRegressor(random_state=123),\n             param_grid={&#x27;max_features&#x27;: [&#x27;sqrt&#x27;, &#x27;log2&#x27;],\n                         &#x27;n_estimators&#x27;: [100, 200, 300, 500]},\n             scoring=&#x27;neg_mean_absolute_error&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-8\" type=\"checkbox\" ><label for=\"sk-estimator-id-8\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(cv=5, estimator=RandomForestRegressor(random_state=123),\n             param_grid={&#x27;max_features&#x27;: [&#x27;sqrt&#x27;, &#x27;log2&#x27;],\n                         &#x27;n_estimators&#x27;: [100, 200, 300, 500]},\n             scoring=&#x27;neg_mean_absolute_error&#x27;)</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-9\" type=\"checkbox\" ><label for=\"sk-estimator-id-9\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: RandomForestRegressor</label><div class=\"sk-toggleable__content\"><pre>RandomForestRegressor(random_state=123)</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-10\" type=\"checkbox\" ><label for=\"sk-estimator-id-10\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestRegressor</label><div class=\"sk-toggleable__content\"><pre>RandomForestRegressor(random_state=123)</pre></div></div></div></div></div></div></div></div></div></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=100}\n``` {.python .cell-code}\n# Best params\nrf_tree_cv.best_params_\n```\n\n::: {.cell-output .cell-output-display execution_count=100}\n```\n{'max_features': 'sqrt', 'n_estimators': 500}\n```\n:::\n:::\n\n\n::: {.cell execution_count=101}\n``` {.python .cell-code}\n# Refit the Random Forest\nrf_tree = RandomForestRegressor(criterion = \"squared_error\",\n                                max_features = rf_tree_cv.best_params_[\"max_features\"],\n                                n_estimators = rf_tree_cv.best_params_[\"n_estimators\"],\n                                random_state = 123)\n\nrf_tree.fit(X_train_clean, y_train)\n```\n\n::: {.cell-output .cell-output-display execution_count=101}\n```{=html}\n<style>#sk-container-id-7 {color: black;background-color: white;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-7\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestRegressor(max_features=&#x27;sqrt&#x27;, n_estimators=500, random_state=123)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-11\" type=\"checkbox\" checked><label for=\"sk-estimator-id-11\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestRegressor</label><div class=\"sk-toggleable__content\"><pre>RandomForestRegressor(max_features=&#x27;sqrt&#x27;, n_estimators=500, random_state=123)</pre></div></div></div></div></div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=102}\n``` {.python .cell-code}\n# Predict\ny_pred_train = rf_tree.predict(X_train_clean)\n\n# Calculate mean absolute error\nmae_rf_cv = mean_absolute_error(y_train, y_pred_train)\n\n# # Calculate R-squared\nr2_rf_cv = r2_score(y_train, y_pred_train)\n\nprint(f\"R2-score: {r2_rf_cv:.4f} and MAE score: {mae_rf_cv:.4f}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.9585 and MAE score: 99.7989\n```\n:::\n:::\n\n\n::: {.cell execution_count=103}\n``` {.python .cell-code}\nsns.jointplot(x=y_train, y=y_pred_train);\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-104-output-1.png){width=579 height=564}\n:::\n:::\n\n\n::: {.cell execution_count=104}\n``` {.python .cell-code}\nmae_score = [mae_baseline, mae_linreg, mae_gb, mae_gb_cv, mae_rf, mae_rf_cv]\nr2_score = [r2_baseline, r2_linreg, r2_gb, r2_gb_cv, r2_rf, r2_rf_cv]\nindexes = [\"baseline\", \"linear regression\", \"gradient boosting\", \"gradient boosting with CV\", \"random forest\",  \"random forest with CV\"]\n\nsummary_df = pd.DataFrame({\n    \"MAE Train\": mae_score,\n    \"R2-Score\": r2_score,\n},index = indexes)\n\nsummary_df.sort_values(by='R2-Score', ascending=False)\n```\n\n::: {.cell-output .cell-output-display execution_count=104}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>MAE Train</th>\n      <th>R2-Score</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>random forest with CV</th>\n      <td>99.798879</td>\n      <td>0.958519</td>\n    </tr>\n    <tr>\n      <th>random forest</th>\n      <td>100.840759</td>\n      <td>0.957661</td>\n    </tr>\n    <tr>\n      <th>gradient boosting with CV</th>\n      <td>228.022510</td>\n      <td>0.819416</td>\n    </tr>\n    <tr>\n      <th>gradient boosting</th>\n      <td>281.683477</td>\n      <td>0.724601</td>\n    </tr>\n    <tr>\n      <th>linear regression</th>\n      <td>319.222873</td>\n      <td>0.646780</td>\n    </tr>\n    <tr>\n      <th>baseline</th>\n      <td>562.370983</td>\n      <td>0.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nFrom the above table, it can be seen that Random Forest model performs the best, and Gradient Boosting at the second place. This is similar to the previous work done by others, on house pricing.\n\n### Best Model\n\n::: {.cell execution_count=105}\n``` {.python .cell-code}\n# libraries\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error, r2_score\n\n\n#setting up\nrf_tree = RandomForestRegressor(n_estimators = 500,\n                                criterion = \"squared_error\",\n                                max_features = \"sqrt\",\n                                random_state = 123)\n\n#fit model train\nrf_tree.fit(X_train_clean, y_train)\n\n# Predict model train\ny_pred_train = rf_tree.predict(X_train_clean)\n\n# Calculate mean absolute error\nmae_rf_cv_train = mean_absolute_error(y_train, y_pred_train)\n\n# # Calculate R-squared\nr2_rf_cv_train = r2_score(y_train, y_pred_train)\n\nprint(f\"R2-score: {r2_rf_cv_train:.3f} and MAE score: +/-{mae_rf_cv_train:.2f} RM\")\n\nsns.scatterplot(x=y_train, y=y_pred_train )\nplt.plot([0, 5500], [0,5500], \"--r\")\nplt.xlim(0, 5500)\nplt.xlabel(\"Actual Monthly Rent\")\nplt.ylim(0,5500)\nplt.ylabel(\"Predicted Monthly Rent\")\nplt.suptitle(\"Random Forest - Best Regression Model\")\nplt.show()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.959 and MAE score: +/-99.80 RM\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-106-output-2.png){width=602 height=477}\n:::\n:::\n\n\n## Data Prediction\n\n### Test Data Preprocessing\n\nSimlar process done in train dataset need to be repeated on test dataset.\n\n::: {.cell execution_count=106}\n``` {.python .cell-code}\n#checking null data\nX_test.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=106}\n```\ncompletion_year    834\nlocation             0\nproperty_type        0\nrooms                0\nparking            506\nbathroom             0\nsize_sqft            0\nfurnished            0\nnearby_railways    552\ndtype: int64\n```\n:::\n:::\n\n\n#### Numerical Data\n\n::: {.cell execution_count=107}\n``` {.python .cell-code}\nX_test_num =  X_test.select_dtypes(exclude='object')\nX_test_num\n```\n\n::: {.cell-output .cell-output-display execution_count=107}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>324</th>\n      <td>NaN</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>1097</td>\n    </tr>\n    <tr>\n      <th>7209</th>\n      <td>2011.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>1200</td>\n    </tr>\n    <tr>\n      <th>1863</th>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>560</td>\n    </tr>\n    <tr>\n      <th>2443</th>\n      <td>2021.0</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>1200</td>\n    </tr>\n    <tr>\n      <th>9218</th>\n      <td>2023.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>300</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>7510</th>\n      <td>2008.0</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>1204</td>\n    </tr>\n    <tr>\n      <th>928</th>\n      <td>2013.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>1.0</td>\n      <td>350</td>\n    </tr>\n    <tr>\n      <th>2181</th>\n      <td>2019.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>653</td>\n    </tr>\n    <tr>\n      <th>4065</th>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>600</td>\n    </tr>\n    <tr>\n      <th>9041</th>\n      <td>2021.0</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>2.0</td>\n      <td>800</td>\n    </tr>\n  </tbody>\n</table>\n<p>1957 rows × 5 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=108}\n``` {.python .cell-code}\nX_test_num.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=108}\n```\ncompletion_year    834\nrooms                0\nparking            506\nbathroom             0\nsize_sqft            0\ndtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=109}\n``` {.python .cell-code}\nX_test_num, imputer_num = numericalImputation(X_test_num, strategy='most_frequent')\nX_test_num.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=109}\n```\ncompletion_year    0\nrooms              0\nparking            0\nbathroom           0\nsize_sqft          0\ndtype: int64\n```\n:::\n:::\n\n\n#### Categorical Data\n\n::: {.cell execution_count=110}\n``` {.python .cell-code}\nX_test_cat = X_test.select_dtypes(include='object')\nX_test_cat\n```\n\n::: {.cell-output .cell-output-display execution_count=110}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>location</th>\n      <th>property_type</th>\n      <th>furnished</th>\n      <th>nearby_railways</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>324</th>\n      <td>South</td>\n      <td>Condominium</td>\n      <td>Partially Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>7209</th>\n      <td>KLCC</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1863</th>\n      <td>Maju</td>\n      <td>Flat</td>\n      <td>Not Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2443</th>\n      <td>Lama</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>9218</th>\n      <td>Cheras</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>7510</th>\n      <td>Setiawangsa</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>yes</td>\n    </tr>\n    <tr>\n      <th>928</th>\n      <td>Road</td>\n      <td>Condominium</td>\n      <td>Fully Furnished</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2181</th>\n      <td>Segambut</td>\n      <td>Service Residence</td>\n      <td>Fully Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>4065</th>\n      <td>Lama</td>\n      <td>Apartment</td>\n      <td>Not Furnished</td>\n      <td>no</td>\n    </tr>\n    <tr>\n      <th>9041</th>\n      <td>Setapak</td>\n      <td>Condominium</td>\n      <td>Partially Furnished</td>\n      <td>yes</td>\n    </tr>\n  </tbody>\n</table>\n<p>1957 rows × 4 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=111}\n``` {.python .cell-code}\nX_test_cat.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=111}\n```\nlocation             0\nproperty_type        0\nfurnished            0\nnearby_railways    552\ndtype: int64\n```\n:::\n:::\n\n\n::: {.cell execution_count=112}\n``` {.python .cell-code}\nX_test_cat, imputer_num = numericalImputation(X_test_cat, strategy='most_frequent')\nX_test_cat.isna().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=112}\n```\nlocation           0\nproperty_type      0\nfurnished          0\nnearby_railways    0\ndtype: int64\n```\n:::\n:::\n\n\n#### Categorical OHE\n\n::: {.cell execution_count=113}\n``` {.python .cell-code}\nX_test_cat_ohe =  pd.get_dummies(X_test_cat)\nX_test_cat_ohe.head(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=113}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>location_Ampang</th>\n      <th>location_Bangsar</th>\n      <th>location_Besi</th>\n      <th>location_Bintang</th>\n      <th>location_Brickfields</th>\n      <th>location_Centre</th>\n      <th>location_Cheras</th>\n      <th>location_City</th>\n      <th>location_Damansara</th>\n      <th>location_Desa</th>\n      <th>...</th>\n      <th>property_type_Duplex</th>\n      <th>property_type_Flat</th>\n      <th>property_type_Others</th>\n      <th>property_type_Service Residence</th>\n      <th>property_type_Studio</th>\n      <th>furnished_Fully Furnished</th>\n      <th>furnished_Not Furnished</th>\n      <th>furnished_Partially Furnished</th>\n      <th>nearby_railways_no</th>\n      <th>nearby_railways_yes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>324</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>7209</th>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 58 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=114}\n``` {.python .cell-code}\nohe_columns = X_test_cat_ohe.columns\nohe_columns\n```\n\n::: {.cell-output .cell-output-display execution_count=114}\n```\nIndex(['location_Ampang', 'location_Bangsar', 'location_Besi',\n       'location_Bintang', 'location_Brickfields', 'location_Centre',\n       'location_Cheras', 'location_City', 'location_Damansara',\n       'location_Desa', 'location_Dutamas', 'location_Gombak',\n       'location_Hartamas', 'location_Heights', 'location_Hilir',\n       'location_Indah', 'location_Ipoh', 'location_Ismail', 'location_Jalil',\n       'location_Jaya', 'location_KLCC', 'location_Kepong', 'location_Keramat',\n       'location_Kiara', 'location_Kuching', 'location_Lama', 'location_Maju',\n       'location_Melawati', 'location_Menjalara', 'location_OUG',\n       'location_Pandan', 'location_Pantai', 'location_ParkCity',\n       'location_Perdana', 'location_Petaling', 'location_Puchong',\n       'location_Pudu', 'location_Road', 'location_Segambut',\n       'location_Selatan', 'location_Sentul', 'location_Seputeh',\n       'location_Setapak', 'location_Setiawangsa', 'location_South',\n       'location_Titiwangsa', 'property_type_Apartment',\n       'property_type_Condominium', 'property_type_Duplex',\n       'property_type_Flat', 'property_type_Others',\n       'property_type_Service Residence', 'property_type_Studio',\n       'furnished_Fully Furnished', 'furnished_Not Furnished',\n       'furnished_Partially Furnished', 'nearby_railways_no',\n       'nearby_railways_yes'],\n      dtype='object')\n```\n:::\n:::\n\n\n### Penggabungan Numerical dan Categorical data\n\n::: {.cell execution_count=115}\n``` {.python .cell-code}\nX_test_concat = pd.concat([X_test_num,\n                            X_test_cat_ohe],\n                           axis = 1)\n```\n:::\n\n\n::: {.cell execution_count=116}\n``` {.python .cell-code}\nX_test_concat.head(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=116}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>location_Ampang</th>\n      <th>location_Bangsar</th>\n      <th>location_Besi</th>\n      <th>location_Bintang</th>\n      <th>location_Brickfields</th>\n      <th>...</th>\n      <th>property_type_Duplex</th>\n      <th>property_type_Flat</th>\n      <th>property_type_Others</th>\n      <th>property_type_Service Residence</th>\n      <th>property_type_Studio</th>\n      <th>furnished_Fully Furnished</th>\n      <th>furnished_Not Furnished</th>\n      <th>furnished_Partially Furnished</th>\n      <th>nearby_railways_no</th>\n      <th>nearby_railways_yes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>324</th>\n      <td>2021.0</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>1097.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>7209</th>\n      <td>2011.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>1200.0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>2 rows × 63 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=117}\n``` {.python .cell-code}\n#sanity check\nX_test_concat.isnull().sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=117}\n```\ncompletion_year                  0\nrooms                            0\nparking                          0\nbathroom                         0\nsize_sqft                        0\n                                ..\nfurnished_Fully Furnished        0\nfurnished_Not Furnished          0\nfurnished_Partially Furnished    0\nnearby_railways_no               0\nnearby_railways_yes              0\nLength: 63, dtype: int64\n```\n:::\n:::\n\n\n#### Standarisasi\n\n::: {.cell execution_count=118}\n``` {.python .cell-code}\nfrom sklearn.preprocessing import StandardScaler\n\n# Buat fungsi\ndef standardizerData(data):\n    \"\"\"\n    Fungsi untuk melakukan standarisasi data\n    :param data: <pandas dataframe> sampel data\n    :return standardized_data: <pandas dataframe> sampel data standard\n    :return standardizer: method untuk standardisasi data\n    \"\"\"\n    data_columns = data.columns  # agar nama kolom tidak hilang\n    data_index = data.index  # agar index tidak hilang\n\n    # buat (fit) standardizer\n    standardizer = StandardScaler()\n    standardizer.fit(data)\n\n    # transform data\n    standardized_data_raw = standardizer.transform(data)\n    standardized_data = pd.DataFrame(standardized_data_raw)\n    standardized_data.columns = data_columns\n    standardized_data.index = data_index\n\n    return standardized_data, standardizer\n```\n:::\n\n\n::: {.cell execution_count=119}\n``` {.python .cell-code}\nX_test_clean, standardizer = standardizerData(data = X_test_concat)\n```\n:::\n\n\n::: {.cell execution_count=120}\n``` {.python .cell-code}\nX_test_clean.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=120}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>completion_year</th>\n      <th>rooms</th>\n      <th>parking</th>\n      <th>bathroom</th>\n      <th>size_sqft</th>\n      <th>location_Ampang</th>\n      <th>location_Bangsar</th>\n      <th>location_Besi</th>\n      <th>location_Bintang</th>\n      <th>location_Brickfields</th>\n      <th>...</th>\n      <th>property_type_Duplex</th>\n      <th>property_type_Flat</th>\n      <th>property_type_Others</th>\n      <th>property_type_Service Residence</th>\n      <th>property_type_Studio</th>\n      <th>furnished_Fully Furnished</th>\n      <th>furnished_Not Furnished</th>\n      <th>furnished_Partially Furnished</th>\n      <th>nearby_railways_no</th>\n      <th>nearby_railways_yes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>324</th>\n      <td>0.552642</td>\n      <td>0.320875</td>\n      <td>-0.541910</td>\n      <td>0.124936</td>\n      <td>0.555078</td>\n      <td>-0.168453</td>\n      <td>-0.071667</td>\n      <td>-0.120479</td>\n      <td>-0.09361</td>\n      <td>-0.055456</td>\n      <td>...</td>\n      <td>-0.059914</td>\n      <td>-0.161923</td>\n      <td>-0.059914</td>\n      <td>-0.60234</td>\n      <td>-0.045256</td>\n      <td>-0.949656</td>\n      <td>-0.368524</td>\n      <td>1.208981</td>\n      <td>1.563785</td>\n      <td>-1.563785</td>\n    </tr>\n    <tr>\n      <th>7209</th>\n      <td>-0.958283</td>\n      <td>1.620985</td>\n      <td>1.505421</td>\n      <td>2.112746</td>\n      <td>0.933643</td>\n      <td>-0.168453</td>\n      <td>-0.071667</td>\n      <td>-0.120479</td>\n      <td>-0.09361</td>\n      <td>-0.055456</td>\n      <td>...</td>\n      <td>-0.059914</td>\n      <td>-0.161923</td>\n      <td>-0.059914</td>\n      <td>-0.60234</td>\n      <td>-0.045256</td>\n      <td>1.053013</td>\n      <td>-0.368524</td>\n      <td>-0.827143</td>\n      <td>-0.639474</td>\n      <td>0.639474</td>\n    </tr>\n    <tr>\n      <th>1863</th>\n      <td>0.552642</td>\n      <td>-0.979234</td>\n      <td>-0.541910</td>\n      <td>-1.862873</td>\n      <td>-1.418602</td>\n      <td>-0.168453</td>\n      <td>-0.071667</td>\n      <td>-0.120479</td>\n      <td>-0.09361</td>\n      <td>-0.055456</td>\n      <td>...</td>\n      <td>-0.059914</td>\n      <td>6.175759</td>\n      <td>-0.059914</td>\n      <td>-0.60234</td>\n      <td>-0.045256</td>\n      <td>-0.949656</td>\n      <td>2.713531</td>\n      <td>-0.827143</td>\n      <td>-0.639474</td>\n      <td>0.639474</td>\n    </tr>\n    <tr>\n      <th>2443</th>\n      <td>0.552642</td>\n      <td>0.320875</td>\n      <td>-0.541910</td>\n      <td>0.124936</td>\n      <td>0.933643</td>\n      <td>-0.168453</td>\n      <td>-0.071667</td>\n      <td>-0.120479</td>\n      <td>-0.09361</td>\n      <td>-0.055456</td>\n      <td>...</td>\n      <td>-0.059914</td>\n      <td>-0.161923</td>\n      <td>-0.059914</td>\n      <td>-0.60234</td>\n      <td>-0.045256</td>\n      <td>1.053013</td>\n      <td>-0.368524</td>\n      <td>-0.827143</td>\n      <td>-0.639474</td>\n      <td>0.639474</td>\n    </tr>\n    <tr>\n      <th>9218</th>\n      <td>0.854826</td>\n      <td>-2.279344</td>\n      <td>1.505421</td>\n      <td>0.124936</td>\n      <td>-2.374201</td>\n      <td>-0.168453</td>\n      <td>-0.071667</td>\n      <td>-0.120479</td>\n      <td>-0.09361</td>\n      <td>-0.055456</td>\n      <td>...</td>\n      <td>-0.059914</td>\n      <td>-0.161923</td>\n      <td>-0.059914</td>\n      <td>-0.60234</td>\n      <td>-0.045256</td>\n      <td>1.053013</td>\n      <td>-0.368524</td>\n      <td>-0.827143</td>\n      <td>-0.639474</td>\n      <td>0.639474</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 63 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Test Data Result\n\n::: {.cell execution_count=121}\n``` {.python .cell-code}\n# libraries\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error, r2_score\n\n\n#setting up\nrf_tree = RandomForestRegressor(n_estimators = 500,\n                                criterion = \"squared_error\",\n                                max_features = \"sqrt\",\n                                random_state = 123)\n\n#fit model train\nrf_tree.fit(X_train_clean, y_train)\n\n# Predict model\ny_pred_test = rf_tree.predict(X_test_clean)\n\n# Calculate mean absolute error\nmae_rf_cv_test = mean_absolute_error(y_test, y_pred_test)\n\n# # Calculate R-squared\nr2_rf_cv_test = r2_score(y_test, y_pred_test)\n\nprint(f\"R2-score: {r2_rf_cv_test:.3f} and MAE score: +/-{mae_rf_cv_test:.2f} RM\")\n\nsns.scatterplot(x=y_test, y=y_pred_test )\nplt.plot([0, 5500], [0,5500], \"--r\")\nplt.xlim(0, 5500)\nplt.xlabel(\"Actual Monthly Rent\")\nplt.ylim(0,5500)\nplt.ylabel(\"Predicted Monthly Rent\")\nplt.suptitle(\"Random Forest - Best Regression Model\")\nplt.show()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR2-score: 0.803 and MAE score: +/-214.08 RM\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-122-output-2.png){width=602 height=477}\n:::\n:::\n\n\n::: {.cell execution_count=122}\n``` {.python .cell-code}\nmae_score = [mae_rf_cv_train, mae_rf_cv_test]\nr2_score = [r2_rf_cv_train, r2_rf_cv_test]\nindexes = [\"train\", \"test\"]\n\nsummary_df_train_test = pd.DataFrame({\n    \"MAE Train\": mae_score,\n    \"R2-Score\": r2_score,\n},index = indexes)\n\nsummary_df_train_test\n```\n\n::: {.cell-output .cell-output-display execution_count=122}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>MAE Train</th>\n      <th>R2-Score</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>train</th>\n      <td>99.798879</td>\n      <td>0.958519</td>\n    </tr>\n    <tr>\n      <th>test</th>\n      <td>214.084111</td>\n      <td>0.802556</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n#### Feature Importance\n\n::: {.cell execution_count=123}\n``` {.python .cell-code}\n# calculate the feature importances\nimportances = rf_tree.feature_importances_\n\n# rescale the importances back to the original scale of the features\nimportances = importances * X_train_clean.std()\n\n# sort the feature importances in descending order\nsorted_index = importances.argsort()[::-1]\n\n# print the feature importances\ndict_feature_importance = {}\nfor i in sorted_index:\n    # print(\"{}: {}\".format(X_train_clean.columns[i], importances[i]))\n    dict_feature_importance.update({X_train_clean.columns[i]: importances[i]})\n    \n# Create a DataFrame from the dictionary\ndf = pd.DataFrame.from_dict(dict_feature_importance, orient='index', columns=['values'])\n\n# Reset the index to become a column\ndf = df.reset_index()\n\n# Rename the columns\ndf.columns = ['feature', 'importance_value']\n\ndf.sort_values(by='importance_value', ascending=False).head(10)\n```\n\n::: {.cell-output .cell-output-display execution_count=123}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>feature</th>\n      <th>importance_value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>size_sqft</td>\n      <td>0.227595</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>furnished_Fully Furnished</td>\n      <td>0.106722</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>completion_year</td>\n      <td>0.073598</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>bathroom</td>\n      <td>0.059699</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>rooms</td>\n      <td>0.046285</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>parking</td>\n      <td>0.045606</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>location_Kiara</td>\n      <td>0.042962</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>furnished_Not Furnished</td>\n      <td>0.040320</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>location_KLCC</td>\n      <td>0.037287</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>furnished_Partially Furnished</td>\n      <td>0.036137</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Results\n\n1.  Result indicates that the best model for prediction is Random Forest with hyperparameter tuning, scoring 95% on R2-score, and a shy 100 RM on MAE. This proves to be a good model since the test dataset gives a scoring of 80% on R2, and 240 RM on MAE.\n\n2.  There are some factors that author believed to be affecting the result/ performance of the model:\n\n    1.  Dropping missing value reduces the performance! Initial model uses half of the data (4-5k rows) and gives poorer performance on R2 and MAE. Imputation and keeping the number of rows close to the original dataset (9k rows) proves to be improving the model. Especially on test dataset.\n    2.  Feature selection importance can be seen on the last table, but initially the selection was based on paper and intuition of the author (author lives and work in KL, Malaysia for 5 years). Feature such as `completion_year` and `nearby_railways` are important in improving the model.\n    3.  Last but not least is the outlier identification. The best practice for me is using jointplot to see not only the distribution of the data in 2-dimension, but also in the third dimension (the density) of the data.\n\n3.  Some of the feature that were believed to be quite important even before doing the modeling is size, furnished and location. All three is available within the 10-most features affecting the modeling. As a context, location in KLCC is like Pondok Indah in South Jakarta. Location in Kiara is like BSD in South Tangerang.\n\n### Discussions\n\n1.  One of the feature that author thinks is significant but not appearing on the 10-best important feature is nearby_railways. This column is showing if a certain property has a close proximity to a railways (KTM/LRT). The issue is, half of the data is missing, hence the imputation. Author belives, the proximity to nearby railways line can be approximated using manhanttan distance of railways line to each property unit.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script src=\"https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js\" crossorigin=\"anonymous\"></script>\n"
      ],
      "include-after-body": [
        "<script type=application/vnd.jupyter.widget-state+json>\n{\"state\":{\"051ac99d16b74f708ce4d8ac25f444c8\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"141858c2437f47ae91749a1bd14cb5c1\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_c5ded7344bfd4a5f9f164e9f17ab2ebc\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_ff435a92001948aaac40e562c4a0cce7\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 40/40 [00:19&lt;00:00,  2.91it/s]\"}},\"1433336012bc497fa3475e3219fd5016\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_3041a77e49e143d69821628f8cdabde9\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_51deef7986ff48d1a6cee7199d5ed04a\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 40/40 [00:19&lt;00:00,  2.57it/s]\"}},\"150d804bcc4d4aba91e73d785ca463d4\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"15894aadade44934bdb0c5d98d57ae0b\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_6e3451c14a66455fbf9296325fb84797\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_96caa90ecf9d44448d7ed1c0cbb22502\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"168121e8b88f46689193d49f74eef9a6\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"1c92e65be74549d5ae032e536279d95b\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"2382615e8d654735a6155b1965248374\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"29219581cac045eca147a99e3eb27463\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_6de374192be245059655d204ceb8ce76\",\"IPY_MODEL_97e481d2eefe427da11fca351d363f84\",\"IPY_MODEL_827c32f491994056b76c496b44fdcf88\"],\"layout\":\"IPY_MODEL_d278d08445d14438865f6644d5adcb4a\",\"tabbable\":null,\"tooltip\":null}},\"296743c7468a4b1b819ed9a447f1c95f\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"2fc3f71673b0462ab2c5ef33004654ec\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_d7acdc3ff88a4f88ac94c1bc5b66a672\",\"max\":40,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_b7cdc99c92e64a4bae507353cb9094b2\",\"tabbable\":null,\"tooltip\":null,\"value\":40}},\"3041a77e49e143d69821628f8cdabde9\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"321abed293f242c084f1307f4139c32b\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"335262cd7c9840ef9896b5afe551f8cf\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"348f578dae4a4b188cbdf1bd52a3935d\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"374986105b8a4effbaa6882a3e06e280\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"3849af5b319a48e6a967104c509d184f\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_be389b644b9047f385592a416dca85b5\",\"max\":1,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_2382615e8d654735a6155b1965248374\",\"tabbable\":null,\"tooltip\":null,\"value\":1}},\"3e7ec6ba2b1746f38dfe22a1333e4670\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_cadd7cee33cf4d1dadf2311bc76db941\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_374986105b8a4effbaa6882a3e06e280\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"47a0ed416570449fb3dbb6a971527961\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"4aa1689daf15413ba4d4fd21ee7f8184\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"4b39062b60ef4d94974b5ea53a1eae69\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_6c4bc0389be943ef8bfa5a5bce656879\",\"max\":40,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_a2245a4b2d62437983a4dd46d548f2aa\",\"tabbable\":null,\"tooltip\":null,\"value\":40}},\"517ed8baeb3e402eaac98e15ca7a5851\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"51deef7986ff48d1a6cee7199d5ed04a\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"56f6bdd355b64cf88a2c2379d4cc89c8\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_296743c7468a4b1b819ed9a447f1c95f\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_1c92e65be74549d5ae032e536279d95b\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 2/2 [00:02&lt;00:00,  1.16s/it]\"}},\"6404371b21fe4b8cbf39f9cc7bf25f09\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_cfed1d4a5dc34a69bddc7febd362df73\",\"max\":1,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_af62ffc96f724f0894f6c654ae84d9d1\",\"tabbable\":null,\"tooltip\":null,\"value\":1}},\"66e7dce372194e0aa67c5ab768a22634\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_47a0ed416570449fb3dbb6a971527961\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_de33e908df9044989a3e537fa8ca6023\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 40/40 [00:21&lt;00:00,  1.10it/s]\"}},\"6c4bc0389be943ef8bfa5a5bce656879\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"6de374192be245059655d204ceb8ce76\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_9a46a833224b429f8ec215e1ae358bd3\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_d773f814b2f34535a4e32a1664fed522\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"6e3451c14a66455fbf9296325fb84797\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"7489de36af0b49ae89788488f68d93b5\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"762decbc722343059efb9355c73c399d\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_a6a9621498b94559a87c1b16c4c0f3d9\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_c972a687f80d47eabfdb786b40e445cc\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 1/1 [00:00&lt;00:00,  1.28it/s]\"}},\"7fbdb4adb7eb4994b0c87cccd3442b82\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"827c32f491994056b76c496b44fdcf88\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_348f578dae4a4b188cbdf1bd52a3935d\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_923a21a61f0f4f6c8e1619ecc319b564\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 1/1 [00:00&lt;00:00,  1.01it/s]\"}},\"857c55d6d6ac4cf4a56f601c51a4d6bc\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"87e80f878d734cba96a223c8290fe788\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_15894aadade44934bdb0c5d98d57ae0b\",\"IPY_MODEL_99d62c8c947546b099ce229cbe6edc40\",\"IPY_MODEL_56f6bdd355b64cf88a2c2379d4cc89c8\"],\"layout\":\"IPY_MODEL_335262cd7c9840ef9896b5afe551f8cf\",\"tabbable\":null,\"tooltip\":null}},\"901d867a84f4417eb283adff5e89a965\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_a60c7f9d0ed240bc957d5b186b7da025\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_f3321afed6c24dc1a8082a1262c80848\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"923a21a61f0f4f6c8e1619ecc319b564\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"962d189537be469fa1be8c8471915982\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_ccd104b9f773494c9b0ceb44386fa7dd\",\"IPY_MODEL_4b39062b60ef4d94974b5ea53a1eae69\",\"IPY_MODEL_141858c2437f47ae91749a1bd14cb5c1\"],\"layout\":\"IPY_MODEL_150d804bcc4d4aba91e73d785ca463d4\",\"tabbable\":null,\"tooltip\":null}},\"966449790c1a4e92be66ab4344a5e691\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"96caa90ecf9d44448d7ed1c0cbb22502\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"97e481d2eefe427da11fca351d363f84\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_f8ac1790ba9445c1b661fb7e31ea9e23\",\"max\":1,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_321abed293f242c084f1307f4139c32b\",\"tabbable\":null,\"tooltip\":null,\"value\":1}},\"986aba78d0354665b376d2d3da8532f7\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"99d62c8c947546b099ce229cbe6edc40\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_f7cf8cb43cae41cdaa5801593fd681b1\",\"max\":2,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_b7c36bcca1d544a881331bd54d3bb5e1\",\"tabbable\":null,\"tooltip\":null,\"value\":2}},\"9a46a833224b429f8ec215e1ae358bd3\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"a1074c835be6417390980c0059ff14bb\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_c69c3ef85590475180104b421f8618f6\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_aa79febb1bac40f68a8640c5b0b269d3\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"a2245a4b2d62437983a4dd46d548f2aa\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"a60c7f9d0ed240bc957d5b186b7da025\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"a6a9621498b94559a87c1b16c4c0f3d9\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"aa79febb1bac40f68a8640c5b0b269d3\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"af62ffc96f724f0894f6c654ae84d9d1\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"b02931c72c2643b4ae9d7e9b73eae342\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"b7c36bcca1d544a881331bd54d3bb5e1\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"b7cdc99c92e64a4bae507353cb9094b2\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"ProgressStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"ProgressStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"bar_color\":null,\"description_width\":\"\"}},\"be389b644b9047f385592a416dca85b5\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"c38a80e873174ebbb96a6d0188d3eff3\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"FloatProgressModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"FloatProgressModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"ProgressView\",\"bar_style\":\"success\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_986aba78d0354665b376d2d3da8532f7\",\"max\":40,\"min\":0,\"orientation\":\"horizontal\",\"style\":\"IPY_MODEL_4aa1689daf15413ba4d4fd21ee7f8184\",\"tabbable\":null,\"tooltip\":null,\"value\":40}},\"c5ded7344bfd4a5f9f164e9f17ab2ebc\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"c69c3ef85590475180104b421f8618f6\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"c972a687f80d47eabfdb786b40e445cc\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"cadd7cee33cf4d1dadf2311bc76db941\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"ccd104b9f773494c9b0ceb44386fa7dd\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_051ac99d16b74f708ce4d8ac25f444c8\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_7fbdb4adb7eb4994b0c87cccd3442b82\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"cdec6e23b87c4d8db965f85af4bfb506\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_a1074c835be6417390980c0059ff14bb\",\"IPY_MODEL_6404371b21fe4b8cbf39f9cc7bf25f09\",\"IPY_MODEL_762decbc722343059efb9355c73c399d\"],\"layout\":\"IPY_MODEL_b02931c72c2643b4ae9d7e9b73eae342\",\"tabbable\":null,\"tooltip\":null}},\"cfed1d4a5dc34a69bddc7febd362df73\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"d18aa32abee74382a92df39a093217a3\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_901d867a84f4417eb283adff5e89a965\",\"IPY_MODEL_3849af5b319a48e6a967104c509d184f\",\"IPY_MODEL_f80904062ecd4845813e26a7a7fe47e8\"],\"layout\":\"IPY_MODEL_d337313e51c140deb81b5bb76fbaa53d\",\"tabbable\":null,\"tooltip\":null}},\"d278d08445d14438865f6644d5adcb4a\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"d337313e51c140deb81b5bb76fbaa53d\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"d773f814b2f34535a4e32a1664fed522\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"d7acdc3ff88a4f88ac94c1bc5b66a672\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"de33e908df9044989a3e537fa8ca6023\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"e0a5ae6bf59740d390e7771a434e564a\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_e6cb30cb58e44f73a7877f60f9b6ac6f\",\"IPY_MODEL_c38a80e873174ebbb96a6d0188d3eff3\",\"IPY_MODEL_66e7dce372194e0aa67c5ab768a22634\"],\"layout\":\"IPY_MODEL_7489de36af0b49ae89788488f68d93b5\",\"tabbable\":null,\"tooltip\":null}},\"e4076aa891e740e38f0f5801e8cb79c6\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HBoxModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HBoxModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HBoxView\",\"box_style\":\"\",\"children\":[\"IPY_MODEL_3e7ec6ba2b1746f38dfe22a1333e4670\",\"IPY_MODEL_2fc3f71673b0462ab2c5ef33004654ec\",\"IPY_MODEL_1433336012bc497fa3475e3219fd5016\"],\"layout\":\"IPY_MODEL_517ed8baeb3e402eaac98e15ca7a5851\",\"tabbable\":null,\"tooltip\":null}},\"e6cb30cb58e44f73a7877f60f9b6ac6f\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_966449790c1a4e92be66ab4344a5e691\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_168121e8b88f46689193d49f74eef9a6\",\"tabbable\":null,\"tooltip\":null,\"value\":\"100%\"}},\"f3321afed6c24dc1a8082a1262c80848\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}},\"f4291dd030174f958b88990f4e063542\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"f7cf8cb43cae41cdaa5801593fd681b1\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"f80904062ecd4845813e26a7a7fe47e8\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLModel\",\"state\":{\"_dom_classes\":[],\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/controls\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"HTMLView\",\"description\":\"\",\"description_allow_html\":false,\"layout\":\"IPY_MODEL_f4291dd030174f958b88990f4e063542\",\"placeholder\":\"​\",\"style\":\"IPY_MODEL_857c55d6d6ac4cf4a56f601c51a4d6bc\",\"tabbable\":null,\"tooltip\":null,\"value\":\" 1/1 [00:03&lt;00:00,  3.14s/it]\"}},\"f8ac1790ba9445c1b661fb7e31ea9e23\":{\"model_module\":\"@jupyter-widgets/base\",\"model_module_version\":\"2.0.0\",\"model_name\":\"LayoutModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/base\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"LayoutModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"LayoutView\",\"align_content\":null,\"align_items\":null,\"align_self\":null,\"border_bottom\":null,\"border_left\":null,\"border_right\":null,\"border_top\":null,\"bottom\":null,\"display\":null,\"flex\":null,\"flex_flow\":null,\"grid_area\":null,\"grid_auto_columns\":null,\"grid_auto_flow\":null,\"grid_auto_rows\":null,\"grid_column\":null,\"grid_gap\":null,\"grid_row\":null,\"grid_template_areas\":null,\"grid_template_columns\":null,\"grid_template_rows\":null,\"height\":null,\"justify_content\":null,\"justify_items\":null,\"left\":null,\"margin\":null,\"max_height\":null,\"max_width\":null,\"min_height\":null,\"min_width\":null,\"object_fit\":null,\"object_position\":null,\"order\":null,\"overflow\":null,\"padding\":null,\"right\":null,\"top\":null,\"visibility\":null,\"width\":null}},\"ff435a92001948aaac40e562c4a0cce7\":{\"model_module\":\"@jupyter-widgets/controls\",\"model_module_version\":\"2.0.0\",\"model_name\":\"HTMLStyleModel\",\"state\":{\"_model_module\":\"@jupyter-widgets/controls\",\"_model_module_version\":\"2.0.0\",\"_model_name\":\"HTMLStyleModel\",\"_view_count\":null,\"_view_module\":\"@jupyter-widgets/base\",\"_view_module_version\":\"2.0.0\",\"_view_name\":\"StyleView\",\"background\":null,\"description_width\":\"\",\"font_size\":null,\"text_color\":null}}},\"version_major\":2,\"version_minor\":0}\n</script>\n"
      ]
    }
  }
}